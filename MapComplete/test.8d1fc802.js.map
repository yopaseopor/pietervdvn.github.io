{"version":3,"sources":["UI/UIEventSource.ts","UI/UIElement.ts","UI/Base/VariableUIElement.ts","test.ts"],"names":[],"mappings":";;;;;;AGAA,IAAA,eAAA,GAAA,OAAA,CAAA,oBAAA,CAAA;AFEA,ADFA,ICEA,ADFA,SCEA,IDFA;ACEA,ADFA,AGQA,IAAA,mBAAA,GAAA,OAAA,CAAA,6BAAA,CAAA;AFNA,ADFA,YCEA,ADFA;ACWI,ADNA,AGMJ,IAAM,IAAI,GFAN,ADNA,AGMS,IAAI,KFAb,CAAsB,GDNtB,CAAY,ECMZ,EAAgD,ADNhD,CGMa,CHNM,AGMN,aAAJ,CAA0B,WAA1B,CAAb;AFFY,ADNA,AGUZ,IAAM,KFJM,ADNA,IGUG,GAAG,GHVN,CGUU,CFJV,CDNa,ECME,ADNf,KCMA,UEIU,CAAA,iBAAJ,CAAsB,IAAtB,CAAlB;AFDQ,ADNA,AGQR,SFFa,ADNA,AGQJ,CAAC,CFFF,EDNA,CCMU,EDNE,EGQpB,CAAmB,CHRX,QGQR,EFFkC,SAAS,CAAC,MAApC;AACA,ADNH,AGSL,MAAM,CAAC,EFHM,OAAL,CEGR,CAAkB,CFHK,MAAf,KEGU;AFFV,AEEiB,EAAA,EFFjB,EEEqB,CAAC,MFFb,CAAC,AEEO,CAAa,KFF9B,WEEiB;AFDjB,ADLG,AGM6C,CAAxD,CHNW,CGM+C,IAA1D,EFDa,MDLF,CAAA,CCKH,CAAc,MAAd,CDLG,CAAA,WAAA,GAAP,UAAmB,QAAnB,EAAuD;ACMtD,ADLG,SAAK,UAAL,CAAgB,IAAhB,CAAqB,QAArB;;ACQG,ADPH,ECOG,SAAA,ADPI,CCOJ,GDPH,MCOG,CAAA,QAAA,GAAP,UAAgB,MAAhB,EAA0C;AACtC,ADPH,GAHM,KCUC,MAAM,KAAK,SAAf,EAA0B;AACtB;AACH,ADPE,EAAA,aAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAAmB;AACf,QAAI,KAAK,IAAL,KAAc,CAAlB,EAAqB;ACOrB,ADNI,QCME,IAAI,GAAG,IAAb;AACA,ADNC,ICMD,MAAM,CAAC,WAAP,CAAmB,YAAA;AACf,MAAA,IAAI,CAAC,MAAL;AACH,ADPD,KCKA,IDLK,IAAL,GAAY,CAAZ;ACQH,ADPG,GCDG,MDCE,IAAL;AACH,GANM;ACgBA,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAA8B;AAC1B,ADTG,EAAA,OCSE,MDTF,CAAA,CCSH,GAAgB,CAAhB,IDTG,CAAA,IAAA,GAAP,YAAA;ACUI,ADTA,SCSK,ADTkB,IAAA,ECSvB,ADTuB,GAAA,CAAA,EAAA,EAAA,GAAA,KAAK,UAA5B,EAAuB,EAAA,GAAA,EAAA,CAAA,MAAvB,EAAuB,EAAA,EAAvB,EAAwC;ACUxC,ADVK,UAAM,CCUJ,IAAP,GDVmB,GAAA,EAAA,CAAA,EAAA,CAAd;AExBb,ADmCK,ADVO,GCMD,CC/BX,EFyBY,QAAQ,CEzBpB,AFyBqB,GEzBrB,EFyB0B,IAAN,CEzBpB,AFyBY,CEzBZ,cAAA,CAAA;AF0BS;AEvBT,ADkCI,ADVC,ECUD,CDdO,CEpBX,ODkCI,CAAA,SClCJ,ADkCI,CAAA,MAAA,GAAA,YAAA;AClCJ,ADmCQ,QAAI,OAAO,GAAG,QAAQ,CAAC,cAAT,CAAwB,KAAK,EAA7B,CAAd;ACnCR,AF0BW,EAAA,QE1BX,KF0BW,CE1BX,AF0BW,EE1BX,OF0BW,CAAA,GAAA,GAAP,UAAc,CAAd,EACc,YADd,EACsD;AE3BnB,ADoC/B,ADTU,EE3BqB,MDoC3B,ADTM,GE3BqB,CAAA,GDoCpB,KAAK,ADTN,ICSN,CDTM,GCSc,CCpCO,CF2BrB,CE3BqB,AF2BrB,EAAA,ECSqB,ECpCA,CAAA,EDoCK,SAApC,EAA+C;AAC3C,ADVM,MAAA,YAAA,GAAA,EAAA;AEvBd,ADkCQ,ADX8C,WEvBtD,iBAAA,CAAY,IAAZ,EAAyC,WAAzC,EAAwG;AAA/D,ADmCpC,QCnCoC,WAAA,KAAA,KAAA,CAAA,EAAA;AAAA,AFwBrC,MExBqC,EFwB/B,IAAI,GAAG,EExBwB,EFwBrC,CExBqC,SAAA;AAA+D,ADqCpG,IAAA,OAAO,CAAC,SAAR,GAAoB,KAAK,WAAL,EAApB;ADXA,QAAM,MAAM,GAAG,SAAT,MAAS,GAAA;AE1BnB,ADsCI,ADXI,MAAA,EE3BR,ADsCQ,KCtCR,ADsCa,EDXI,CE1Bb,AF0Bc,ME1Bd,CAAA,AF0BI,CAAkB,CCWtB,ADXuB,CAAC,CE1BxB,ADqCuB,CCrCvB,EF0B4B,CAAC,CE1B7B,EAAM,CF0BiB,CAAnB,EE1BJ,KAAW,IADf;ADuCQ,ADXA,MAAA,ICWI,KDXK,CAAC,CCWC,CAAC,EDXZ,OCWI,KAAsB,EAA1B,EAA8B;ACrClC,ADsCQ,ADXP,IE3BD,CFwBA,GCcQ,CCtCJ,CAAC,KAAL,ADsCe,CAAC,ECtCH,IAAb,ODsCQ,CAAsB,KAAtB,CAA4B,OAA5B,GAAsC,MAAtC;ACrCR,ADsCK,ICtCL,GDoCI,ECpCA,CAAC,GDsCM,SCtCX,GAAoB,WAApB;ADuCQ,ADXR,QCWQ,CDXH,MCWU,CAAC,IDXhB,CAAiB,MAAjB,ECWQ,CAAsB,KAAtB,CAA4B,OAA5B,GAAsC,SAAtC;ACrCX,ADsCQ;AACJ,ADZD,SAA0B,IAAA,EAAA,GAAA,CAAA,EAAA,cAAA,GAAA,YAA1B,EAA0B,EAAA,GAAA,cAAA,CAAA,MAA1B,EAA0B,EAAA,EAA1B,EAAwC;AEzBlC,AFyBD,EEzBC,QFyBK,SEzBL,CAAA,CFyBgB,GAAA,KEzBhB,CAAA,QFyBgB,CAAA,EEzBhB,AFyBgB,CAAjB,EEzBT,YAAA;AACI,ADsCA,ADbI,MAAA,ECaA,GCtCG,EDsCE,GCtCG,CFyBG,CAAC,GEzBT,ADsCH,CCtCc,IAAlB,ADsCsB,GDblB,CAAwB,KCa5B,CDbI,CCa6B;ACrCpC,ADsCO,ADbH,GE3BK,ODwCI,MAAI,GAAG,IAAb;;ACpCR,ADqCQ,ADbJ,EExBJ,IDqCQ,EDbE,KCaK,CAAC,GDbG,EExBnB,CAAA,AFwBsB,CCad,GAAkB,ADbA,KExB1B,CAAA,MDqC0B,CDbJ,CACd,CAAC,CAAC,CEzBV,GAAA,CFyBe,IAAN,CADa,CAAlB,GExBQ,WAAZ,EAAoC;AAChC,ADqCQ,ADTR,IE5BA,IDqCQ,ECrCR,CAAA,AF4BO,GCSK,CAAC,KCrCb,AF4BA,CE5BM,EDqCE,SCrCR,CAAiB,IAAjB,CAAiB,IAAjB,EAAkB,WAAlB;ADsCK,ADRR,GApBM,IC0BC;ACnCJ,QAAG,KAAK,YAAL,KAAsB,SAAzB,EAAmC;AAC/B,ADqCA,ADNZ,MCMY,GDNZ,EE/BiB,EDqCE,CAAC,KAAR,CAAc,EDN1B,CE/BY,CAAkB,SDqClB,ECrCA,CDqC8B,KAA9B;ACpCH,ADqCG,AD3DZ,CAAA,EAAA,GC2DY,OAAO,CAAC,KAAR,CAAc,MAAd,GAAuB,SAAvB;ACpCP,ADqCM,GC1CP;AFlBS,OAAA,CAAA,aAAA,GAAA,aAAA;AE0Bb,SAAA,iBAAA;AAvBA,CAAA,CAAuC,WAAA,CAAA,SAAvC,CAAA;;AAAa,OAAA,CAAA,iBAAA,GAAA,iBAAA;;;;;;ADoEJ;;AAED,SAAK,WAAL,CAAiB,OAAjB;AACH,GArCD;;AAuCA,EAAA,SAAA,CAAA,SAAA,CAAA,WAAA,GAAA,UAAY,IAAZ,EAA0B;AACtB,SAAK,YAAL,GAAoB,IAApB;AACA,SAAK,MAAL;AACA,WAAO,IAAP;AACH,GAJD,CA1EJ,CAgFI;;;AACA,EAAA,SAAA,CAAA,SAAA,CAAA,WAAA,GAAA,UAAY,WAAZ,EAAqC,CAAG,CAAxC;;AAEA,EAAA,SAAA,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AACI,WAAO,iCAAiC,KAAK,EAAtC,GAA2C,IAA3C,GAAkD,KAAK,WAAL,EAAlD,GAAuE,SAA9E;AACH,GAFD;;AAIA,EAAA,SAAA,CAAA,SAAA,CAAA,QAAA,GAAA,UAAS,KAAT,EAAsB;AAClB,QAAI,OAAO,GAAG,QAAQ,CAAC,cAAT,CAAwB,KAAxB,CAAd;;AACA,QAAG,OAAO,KAAK,IAAf,EAAoB;AAChB,MAAA,OAAO,CAAC,GAAR,CAAY,wCAAZ,EAAsD,KAAtD;AACA;AACH;;AACD,IAAA,OAAO,CAAC,SAAR,GAAoB,KAAK,MAAL,EAApB;AACA,SAAK,MAAL;AACA,WAAO,IAAP;AACH,GATD;;AAYO,EAAA,SAAA,CAAA,SAAA,CAAA,QAAA,GAAP,YAAA,CAA0B,CAAnB;;AAAmB;;AAEnB,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,YAAA;AACI,WAAO,KAAK,WAAL,OAAuB,EAA9B;AACH,GAFM;;AAnGQ,EAAA,SAAA,CAAA,MAAA,GAAiB,CAAjB;AAuGnB,SAAA,SAAA;AAzGA,CAAA,EAAA;;AAAsB,OAAA,CAAA,SAAA,GAAA,SAAA","file":"test.8d1fc802.js","sourceRoot":"..","sourcesContent":["export class UIEventSource<T>{\n    \n    public data : T;\n    private _callbacks = [];\n\n    constructor(data: T) {\n        this.data = data;\n    }\n\n\n    public addCallback(callback: ((latestData : T) => void)) {\n        this._callbacks.push(callback);\n        return this;\n    }\n\n    public setData(t: T): void {\n        if (this.data === t) {\n            return;\n        }\n        this.data = t;\n        this.ping();\n    }\n\n    public ping(): void {\n        for (const callback of this._callbacks) {\n            callback(this.data);\n        }\n    }\n\n    public map<J>(f: ((T) => J),\n                  extraSources : UIEventSource<any>[] = []): UIEventSource<J> {\n        const self = this;\n        \n        const update = function () {\n            newSource.setData(f(self.data));\n            newSource.ping();\n        }\n        \n        this.addCallback(update);\n        for (const extraSource of extraSources) {\n            extraSource.addCallback(update);\n        }\n        const newSource = new UIEventSource<J>(\n            f(this.data)\n        );\n        \n\n        return newSource;\n\n    }\n\n\n}","import {UIEventSource} from \"./UIEventSource\";\n\nexport abstract class UIElement {\n\n    private static nextId: number = 0;\n\n    public readonly id: string;\n    public readonly _source: UIEventSource<any>;\n    \n    private _hideIfEmpty = false;\n\n    protected constructor(source: UIEventSource<any>) {\n        this.id = \"ui-element-\" + UIElement.nextId;\n        this._source = source;\n        UIElement.nextId++;\n        this.ListenTo(source);\n    }\n\n\n    public ListenTo(source: UIEventSource<any>) {\n        if (source === undefined) {\n            return;\n        }\n        const self = this;\n        source.addCallback(() => {\n            self.Update();\n        })\n    }\n\n    private _onClick: () => void;\n\n    public onClick(f: (() => void)) {\n        this._onClick = f;\n        this.Update();\n        return this;\n    }\n\n    Update(): void {\n        let element = document.getElementById(this.id);\n        if (element === null || element === undefined) {\n            // The element is not painted\n            return;\n        }\n\n        element.innerHTML = this.InnerRender();\n        if (this._hideIfEmpty) {\n            if (element.innerHTML === \"\") {\n                element.parentElement.style.display = \"none\";\n            } else {\n                element.parentElement.style.display = undefined;\n            }\n        }\n\n        if (this._onClick !== undefined) {\n            const self = this;\n            element.onclick = () => {\n                self._onClick();\n            }\n            element.style.pointerEvents = \"all\";\n            element.style.cursor = \"pointer\";\n           /*\n            const childs = element.children;\n            for (let i = 0; i < childs.length; i++) {\n                const ch = childs[i];\n                console.log(ch);\n                ch.style.cursor = \"pointer\";\n                ch.onclick = () => {\n                    self._onClick();\n                }\n                ch.style.pointerEvents = \"all\";\n            }*/\n        }\n\n        this.InnerUpdate(element);\n    }\n    \n    HideOnEmpty(hide : boolean){\n        this._hideIfEmpty = hide;\n        this.Update();\n        return this;\n    }\n    \n    // Called after the HTML has been replaced. Can be used for css tricks\n    InnerUpdate(htmlElement : HTMLElement){}\n\n    Render(): string {\n        return \"<span class='uielement' id='\" + this.id + \"'>\" + this.InnerRender() + \"</span>\"\n    }\n\n    AttachTo(divId: string) {\n        let element = document.getElementById(divId);\n        if(element === null){\n            console.log(\"SEVERE: could not attach UIElement to \", divId);\n            return;\n        }\n        element.innerHTML = this.Render();\n        this.Update();\n        return this;\n    }\n\n    protected abstract InnerRender(): string;\n    public Activate(): void {};\n\n    public IsEmpty(): boolean {\n        return this.InnerRender() === \"\";\n    }\n\n}","import {UIElement} from \"../UIElement\";\nimport {UIEventSource} from \"../UIEventSource\";\n\nexport class VariableUiElement extends UIElement {\n    private _html: UIEventSource<string>;\n    private _innerUpdate: (htmlElement: HTMLElement) => void;\n\n    constructor(html: UIEventSource<string>, innerUpdate : ((htmlElement : HTMLElement) => void) = undefined) {\n        super(html);\n        this._html = html;\n        this._innerUpdate = innerUpdate;\n\n    }\n\n    protected InnerRender(): string {\n        return this._html.data;\n    }\n    \n    InnerUpdate(htmlElement: HTMLElement) {\n        super.InnerUpdate(htmlElement);\n        if(this._innerUpdate !== undefined){\n            this._innerUpdate(htmlElement);\n        }\n    }\n\n\n}","import {UIEventSource} from \"./UI/UIEventSource\";\nimport {Changes} from \"./Logic/Changes\";\nimport {OsmConnection} from \"./Logic/OsmConnection\";\nimport {ElementStorage} from \"./Logic/ElementStorage\";\nimport {WikipediaLink} from \"./Customizations/Questions/WikipediaLink\";\nimport {OsmLink} from \"./Customizations/Questions/OsmLink\";\nimport {ConfirmDialog} from \"./UI/ConfirmDialog\";\nimport {Imgur} from \"./Logic/Imgur\";\nimport {VariableUiElement} from \"./UI/Base/VariableUIElement\";\n\n\nconst html = new UIEventSource<string>(\"Some text\");\n\nconst uielement = new VariableUiElement(html);\nuielement.AttachTo(\"maindiv\")\n\nwindow.setTimeout(() => {html.setData(\"Different text\")}, 1000)"]}