{"version":3,"sources":["UI/UIEventSource.ts","UI/UIElement.ts","UI/AddButton.ts"],"names":[],"mappings":";;;;;;;ACEA,ADFA,ICEA,ADFA,SCEA,IDFA;ACEA,ADFA;ACEA,ADFA,YCEA,ADFA;ACWI,ADNA,WCMA,ADNA,SCMA,CAAsB,GDNtB,CAAY,ECMZ,EAAgD,ADNhD,EAAmB;ACIX,ADNA,SCMA,ADNA,UAAA,ECMA,CDNa,ECME,ADNf,KCMA;AAGJ,ADNA,SCMK,ADNA,ECML,EDNA,CCMU,EDNE,IAAZ,UCM0B,SAAS,CAAC,MAApC;AACA,ADNH,SCMQ,OAAL,GAAe,MAAf;AACA,IAAA,SAAS,CAAC,MAAV;AACA,ADLG,EAAA,OCKE,MDLF,CAAA,CCKH,CAAc,MAAd,CDLG,CAAA,WAAA,GAAP,UAAmB,QAAnB,EAAuD;ACMtD,ADLG,SAAK,UAAL,CAAgB,IAAhB,CAAqB,QAArB;;ACQG,ADPH,ECOG,SAAA,ADPI,CCOJ,GDPH,MCOG,CAAA,QAAA,GAAP,UAAgB,MAAhB,EAA0C;AACtC,ADPH,GAHM,KCUC,MAAM,KAAK,SAAf,EAA0B;AACtB;AACH,ADPE,EAAA,aAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAAmB;AACf,QAAI,KAAK,IAAL,KAAc,CAAlB,EAAqB;ACOrB,ADNI,QCME,IAAI,GAAG,IAAb;AACA,ADNC,ICMD,MAAM,CAAC,WAAP,CAAmB,YAAA;AACf,MAAA,IAAI,CAAC,MAAL;AACH,ADPD,KCKA,IDLK,IAAL,GAAY,CAAZ;ACQH,ADPG,GCDG,MDCE,IAAL;AACH,GANM;ACgBA,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAA8B;AAC1B,ADTG,EAAA,OCSE,MDTF,CAAA,CCSH,GAAgB,CAAhB,IDTG,CAAA,IAAA,GAAP,YAAA;ACUI,ADTA,SCSK,ADTkB,IAAA,ECSvB,ADTuB,GAAA,CAAA,EAAA,EAAA,GAAA,KAAK,UAA5B,EAAuB,EAAA,GAAA,EAAA,CAAA,MAAvB,EAAuB,EAAA,EAAvB,EAAwC;ACUxC,ADVK,UAAM,CCUJ,IAAP,GDVmB,GAAA,EAAA,CAAA,EAAA,CAAd;AExBb,ADmCK,ADVO,GCMD,CC/BX,EFyBY,QAAQ,CAAC,IEzBrB,CFyB0B,EEzB1B,EFyBoB,CAAR,IEzBZ,CAAA,iBAAA,CAAA;AF0BS;AEzBT,ADoCI,ADVC,ECUD,CDdO,CEtBX,ODoCI,CAAA,GCpCJ,GAAA,GDoCI,CAAA,GCpCJ,CAAA,EDoCI,GAAA,QCpCJ,CAAA,GDoCI;AACI,QAAI,OAAO,GAAG,QAAQ,CAAC,cAAT,CAAwB,KAAK,EAA7B,CAAd;AC9BR,AFqBW,EAAA,EErBX,SAAA,EFqBW,CAAA,SAAA,CAAA,GAAA,GAAP,UAAc,CAAd,EACc,YADd,EACsD;AEtB1D,AD+BQ,ADTU,QCSN,ADTM,OCSC,KAAK,ADTN,ICSN,CDTM,GCSc,EDTd,CAAA,EAAA,ECSqB,KAAK,SAApC,EAA+C;AC/BvD,ADgCY,ADVM,MAAA,IEtBlB,MAAA,EAAA,AFsBkB,GAAA,EAAA;AEtBa,ADiCnB,ADX8C,EEtB3B,SAAA,CAAA,SAAA,EAAA,MAAA,CAAA;ADkCtB;ACdL,AFGI,QAAM,GEHV,CFGc,GAAG,IAAb,CEHJ,CACI,OADJ,EAEI,OAFJ,EAGI,OAHJ,EAQO;AARP,ADgBI,IAAA,IChBJ,GDgBW,CAAC,CChBZ,GASI,KDOA,CCPA,CAAA,CDOoB,GCPpB,CAAA,CDOyB,GCPzB,EAAM,MDOc,EAApB,CCPA,KAAgB,IATpB;AFKI,QAAM,MAAM,GAAG,SAAT,MAAS,GAAA;AEvBZ,ADmCH,ADXI,IExBD,EFwBC,ECWA,CCnCD,CAAA,GDmCM,EDXI,CAAC,OAAV,CAAkB,CCWtB,ADXuB,CAAC,CCWD,CCnCpB,EFwByB,CExBmB,AFwBlB,IExBsB,AFwB5B,CAAnB,cExB+C,CAAA,aAAJ,CAA0B,EAA1B,CAA5C;AAGU,ADiCT,ADXA,IEtBS,EFsBT,GEtBS,CAAA,ADiCL,KDXK,CAAC,CCWC,CAAC,EDXZ,GEtBS,GAAgB,CDiCrB,KAAsB,EAA1B,EAA8B,KCjCrB;AACA,ADiCL,ADXP,IEtBY,CFmBb,GCcQ,CCjCK,CAAA,KDiCE,CAAC,KCjCH,GAAc,KDiCnB,CAAsB,KAAtB,CAA4B,CCjCvB,MDiCL,GAAsC,MAAtC;AC7BZ,AD8BS,OAFD,MAEO;AACH,ADXR,QCWQ,CDXH,MCWU,CAAC,IDXhB,C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","file":"AddButton.js","sourceRoot":"..","sourcesContent":["export class UIEventSource<T>{\n    \n    public data : T;\n    private _callbacks = [];\n\n    constructor(data: T) {\n        this.data = data;\n    }\n\n\n    public addCallback(callback: ((latestData : T) => void)) {\n        this._callbacks.push(callback);\n        return this;\n    }\n\n    public setData(t: T): void {\n        if (this.data === t) {\n            return;\n        }\n        this.data = t;\n        this.ping();\n    }\n\n    public ping(): void {\n        for (const callback of this._callbacks) {\n            callback(this.data);\n        }\n    }\n\n    public map<J>(f: ((T) => J),\n                  extraSources : UIEventSource<any>[] = []): UIEventSource<J> {\n        const self = this;\n        \n        const update = function () {\n            newSource.setData(f(self.data));\n            newSource.ping();\n        }\n        \n        this.addCallback(update);\n        for (const extraSource of extraSources) {\n            extraSource.addCallback(update);\n        }\n        const newSource = new UIEventSource<J>(\n            f(this.data)\n        );\n        \n\n        return newSource;\n\n    }\n\n\n}","import {UIEventSource} from \"./UIEventSource\";\n\nexport abstract class UIElement {\n\n    private static nextId: number = 0;\n\n    public readonly id: string;\n    public readonly _source: UIEventSource<any>;\n    \n    private _hideIfEmpty = false;\n\n    protected constructor(source: UIEventSource<any>) {\n        this.id = \"ui-element-\" + UIElement.nextId;\n        this._source = source;\n        UIElement.nextId++;\n        this.ListenTo(source);\n    }\n\n\n    public ListenTo(source: UIEventSource<any>) {\n        if (source === undefined) {\n            return;\n        }\n        const self = this;\n        source.addCallback(() => {\n            self.Update();\n        })\n    }\n\n    private _onClick: () => void;\n\n    public onClick(f: (() => void)) {\n        this._onClick = f;\n        this.Update();\n        return this;\n    }\n\n    Update(): void {\n        let element = document.getElementById(this.id);\n        if (element === null || element === undefined) {\n            // The element is not painted\n            return;\n        }\n\n        element.innerHTML = this.InnerRender();\n        if (this._hideIfEmpty) {\n            if (element.innerHTML === \"\") {\n                element.parentElement.style.display = \"none\";\n            } else {\n                element.parentElement.style.display = undefined;\n            }\n        }\n\n        if (this._onClick !== undefined) {\n            const self = this;\n            element.onclick = () => {\n                self._onClick();\n            }\n            element.style.pointerEvents = \"all\";\n            element.style.cursor = \"pointer\";\n           /*\n            const childs = element.children;\n            for (let i = 0; i < childs.length; i++) {\n                const ch = childs[i];\n                console.log(ch);\n                ch.style.cursor = \"pointer\";\n                ch.onclick = () => {\n                    self._onClick();\n                }\n                ch.style.pointerEvents = \"all\";\n            }*/\n        }\n\n        this.InnerUpdate(element);\n    }\n    \n    HideOnEmpty(hide : boolean){\n        this._hideIfEmpty = hide;\n        this.Update();\n        return this;\n    }\n    \n    // Called after the HTML has been replaced. Can be used for css tricks\n    InnerUpdate(htmlElement : HTMLElement){}\n\n    Render(): string {\n        return \"<span class='uielement' id='\" + this.id + \"'>\" + this.InnerRender() + \"</span>\"\n    }\n\n    AttachTo(divId: string) {\n        let element = document.getElementById(divId);\n        if(element === null){\n            console.log(\"SEVERE: could not attach UIElement to \", divId);\n            return;\n        }\n        element.innerHTML = this.Render();\n        this.Update();\n        return this;\n    }\n\n    protected abstract InnerRender(): string;\n    public Activate(): void {};\n\n    public IsEmpty(): boolean {\n        return this.InnerRender() === \"\";\n    }\n\n}","import {UIEventSource} from \"./UIEventSource\";\nimport {UIElement} from \"./UIElement\";\nimport {Basemap} from \"../Logic/Basemap\";\nimport {Changes} from \"../Logic/Changes\";\nimport L from \"leaflet\";\nimport {Tag} from \"../Logic/TagsFilter\";\nimport {FilteredLayer} from \"../Logic/FilteredLayer\";\n\nexport class AddButton extends UIElement {\n\n    public curentAddSelection: UIEventSource<string> = new UIEventSource<string>(\"\");\n    private zoomlevel: UIEventSource<{ zoom: number }>;\n\n    private readonly SELECTING_POI = \"selecting_POI\";\n    private readonly PLACING_POI = \"placing_POI\";\n\n    private changes: Changes;\n\n    /*State is one of:\n     * \"\": the default stated\n     * \"select_POI\": show a 'select which POI to add' query (skipped if only one option exists)\n     * \"placing_point\": shown while adding a point\n     * \"\"\n     */\n    private state: UIEventSource<string> = new UIEventSource<string>(\"\");\n    private _options: { name: string; icon: string; tags: Tag[]; layerToAddTo: FilteredLayer }[];\n\n\n    constructor(\n        basemap: Basemap,\n        changes: Changes,\n        options: {\n            name: string,\n            icon: string,\n            tags: Tag[],\n            layerToAddTo: FilteredLayer\n        }[]) {\n        super(undefined);\n\n        this.zoomlevel = basemap.Location;\n        this.ListenTo(this.zoomlevel);\n        this._options = options;\n        this.ListenTo(this.curentAddSelection);\n        this.ListenTo(this.state);\n        this.state.setData(this.SELECTING_POI);\n        this.changes = changes;\n\n        const self = this;\n\n\n        basemap.map.on(\"click\", function (e) {\n                const location = e.latlng;\n                console.log(\"Clicked at \", location)\n                self.HandleClick(location.lat, location.lng)\n            }\n        );\n        \n        basemap.map.on(\"mousemove\", function(){\n            if (self.state.data === self.PLACING_POI) {\n\n                let icon = \"crosshair\";\n                for (const option of self._options) {\n                    if (option.name === self.curentAddSelection.data && option.icon !== undefined) {\n                        icon = 'url(\"' + option.icon + '\") 32 32 ,crosshair';\n                        console.log(\"Cursor icon: \", icon)\n                    }\n                }\n                document.getElementById('leafletDiv').style.cursor = icon;\n\n            } else {\n                // @ts-ignore\n                document.getElementById('leafletDiv').style.cursor = '';\n            }\n        });\n\n\n    }\n\n    private HandleClick(lat: number, lon: number): void {\n        this.state.setData(this.SELECTING_POI);\n        console.log(\"Handling click\", lat, lon, this.curentAddSelection.data);\n        for (const option of this._options) {\n            if (this.curentAddSelection.data === option.name) {\n                console.log(\"PLACING a \", option);\n\n                let feature = this.changes.createElement(option.tags, lat, lon);\n                option.layerToAddTo.AddNewElement(feature);\n\n                return;\n            }\n        }\n    }\n\n    protected InnerRender(): string {\n\n        if (this.zoomlevel.data.zoom < 19) {\n            return \"Zoom in om een punt toe te voegen\"\n        }\n\n        if (this.state.data === this.SELECTING_POI) {\n            var html = \"<form>\";\n            for (const option of this._options) {\n                // <button type='button'> looks SO retarded\n                // the default type of button is 'submit', which performs a POST and page reload\n                html += \"<button type='button' class='addPOIoption' value='\" + option.name + \"'>Voeg een \" + option.name + \" toe</button><br/>\";\n            }\n            html += \"</form>\";\n            return html;\n        }\n\n        if (this.state.data === this.PLACING_POI) {\n            return \"<div id='clickOnMapInstruction'>Klik op de kaart om een nieuw punt toe te voegen<div>\" +\n                \"<div id='cancelInstruction'>Klik hier om toevoegen te annuleren</div>\"\n        }\n\n        if (this.curentAddSelection.data === \"\") {\n            return \"<span onclick>Voeg een punt toe...</span>\"\n        }\n        return \"Annuleer\";\n    }\n\n    InnerUpdate(htmlElement: HTMLElement) {\n        const self = this;\n\n        htmlElement.onclick = function (event) {\n            if(event.consumed){\n                return;\n            }\n            if (self.state.data === self.PLACING_POI) {\n                self.state.setData(self.SELECTING_POI);\n            }\n\n        }\n\n        const buttons = htmlElement.getElementsByClassName('addPOIoption');\n        // @ts-ignore\n        for (const button of buttons) {\n            button.onclick = function (event) {\n                self.curentAddSelection.setData(button.value);\n                self.state.setData(self.PLACING_POI);\n                event.consumed = true;\n            }\n        }\n    }\n\n\n}"]}