{"version":3,"sources":["UI/UIEventSource.ts","UI/UIElement.ts","UI/Base/VariableUIElement.ts","UI/MessageBoxHandler.ts"],"names":[],"mappings":";;;;;;AGAA;AFGA,ADHA,ICGA,ADHA,SCGA,IDHA;ACGA,ADHA;ACGA,ADHA,YCGA,ADHA;AGGA,AFSI,ADPA,IGFJ,OFSI,ADPA,QGFJ,CFSI,CAAsB,CET1B,EHEI,CAAY,ECOZ,EETJ,AFSoD,ADPhD,CGFJ,CHEuB,gBGFvB,CAAA;AFOY,ADPA,SCOA,ADPA,UAAA,ECOA,CDPa,ECOE,ADPf,KCOA;AELZ,AFQQ,ADPA,IGDR,KFQa,ADPA,ECOL,EDPA,CCOU,EDPE,IAAZ,GGDR,GAAA,IFQkC,GERlC,CAAA,KFQ2C,CAAC,MAApC,cERR,CAAA;AFSQ,ADPH,SCOQ,OAAL,GAAe,MAAf;AEPR,AFQQ,IERR,AFQQ,SAAS,CAAC,MAAV,CERR;AAAA,AFSQ,ADNG,EAAA,OCME,MDNF,CAAA,CCMH,CAAc,MAAd,CDNG,CAAA,WAAA,GAAP,UAAmB,QAAnB,EAAuD;AGH3D,AFUK,ADNG,SAAK,GGJb,OHIQ,CAAgB,IAAhB,CAAqB,QAArB;AGDJ,WAAA,iBAAA,CAAY,SAAZ,EACY,OADZ,EACiC;AAC7B,AFQM,ADRN,ECQM,OERD,EFQC,ADRC,CCQD,GDRN,IGAA,EFQM,CERY,AFQZ,QAAA,CERN,EFQJ,UAAmB,MAAnB,EAA6C;AEPzC,AFQA,ADRH,GAHM,KCWC,CERC,KFQK,GERV,CAAc,CFQC,QERf,CFQA,EAA0B;AEP1B,AFQI,SERC,MAAL;AFSC,ADRE,EAAA,aAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAAmB;AGCf,AHAA,IGAA,IHAI,EGAE,CAAC,EHAE,IAAL,KAAc,CGAlB,AHAA,EAAqB,CGAC,YAAA;AAClB,AFOJ,ADPI,QCOE,EEPE,EFOE,GAAG,GEPG,CAAC,AFOjB,IEPQ,KAAkB,EAAtB,EAA0B;AACtB,AFOR,ADPC,ICOD,MAAM,CAAC,WAAP,CAAmB,YAAA;AENX,AFOJ,MAAA,EEPI,EFOA,CAAC,MEPQ,AFOb,CEPc,OAAV,CAAkB,SAAlB;AACA,AFOP,ADRD,KCMA,GELQ,CHDH,IAAL,EGCe,CHDH,CAAZ;AGEK,AFOR,ADRG,GCAM,MDAD,IAAL;AGEC,AHDJ,GANM,EGCH;AFgBG,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAA8B;AER1B,AFSA,ADVG,EAAA,MGCC,CFSC,MDVF,CAAA,CCUH,GAAgB,CAAhB,IDVG,CAAA,CGCC,CAAA,EHDD,GAAP,YGCI,AHDJ,CGC0B,IAAI,eAAA,CAAA,aAAJ,CAA0B,wBAA1B,CAAtB,EACI,YAAA;AACI,AFQR,ADVA,MGEQ,GFQH,ADVA,IAAI,CGEO,AHFhB,CGEiB,AFQjB,GDVc,KAAK,MGEX,CAAwB,GHFhC,EAA+B,OGEvB,EAAsC,OAAtC,GAAgD,YAAA;AAC5C,AFQf,ADVO,GCOD,KELS,GHFH,MGEY,CAAC,GHFlB,CAAgB,CAAhB,EGEQ,AHFW,CGEO,IHFF,IAAxB,CGEQ;AD3BpB,AC4BoB,AHFX,IE1BT,IC4BoB,OD5BpB,AC4B2B,GD5B3B,OAAA,CAAA,cAAA,CAAA;AC6BiB,AFQb,ADVC,ECUD,CDdO,IGGK,IFWZ,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AClCJ,AC2Ba,AFQL,ICnCR,CCqBQ,EAOE,CFOE,OEdJ,AFcW,CEPA,EFOG,GCnCtB,KDmC8B,CAAC,CEdvB,aFcc,CAAwB,KAAK,EAA7B,CAAd;ACnCR,AC+BK,AHLM,EAAA,aAAA,CAAA,SAAA,CAAA,GAAA,GAAP,UAAc,CAAd,EAA2B;AE1B/B,ADoCQ,ADTA,QCSI,ADTE,EE3Bd,EF2BkB,GCSC,ADTE,CE3BrB,EAAA,CF2BQ,CCSgB,IAAZ,IAAoB,OAAO,KAAK,SAApC,EAA+C;ACpChB,ACiCnC,AFIQ,ADTJ,EE5B+B,ACiCnC,OHLS,EE5B0B,CAAA,OCiCnC,CAAA,AHLI,CAAiB,QE5Bc,ACiCnC,CAAA,CDjCmC,EF4Bd,IE5Bc,CAAA,ACiCnC,GAAA,UAAS,aAAT,EAA0C;AACtC,AFII,ADTA,MAAA,EGKE,IAAI,GAAG,AHLA,CAAC,GGKd,IHLI,CAAkB,CAAC,CAAC,IAAI,CAAC,IAAN,CAAnB;AEzBR,AC+BI,AFIC,ADTG,IGKJ,EHLI,KE1BR,IF0BiB,CAAC,CGKD,CAAC,EHLV,QE1BR,CAAY,AC+BR,CAA0B,GD/B9B,EAAyC,OC+BX,ID/B9B,EAAwG;AAA/D,ACgCjC,AHLH,KAHD,CGQI,EDhCiC,ECgC7B,CAAC,MAAL,EDhCiC,KAAA,KAAA,CAAA,EAAA;AAAA,ACiCpC,AFID,ADTA,ICSA,CENA,CD/BqC,EF4B/B,GCSC,CAAC,KCrC6B,AF4BtB,GE5BsB,AF4BnB,CCSlB,GAAoB,ADTE,KE5Be,ADqCZ,QDTP,CACd,CAAC,CCQe,ADRd,ECQN,GDRW,IAAN,CADa,CAAlB;AE5BoG,ACkCvG,AHFG,GGHJ,QHGW,SAAP;ACMA,ADJH,GAZM,KCgBC,KAAK,YAAT,EAAuB;ACtC3B,ACqCA,AFEQ,EEFR,MDrCA,EDuCY,GCvCZ,GACI,CDsCe,CAAC,CEFpB,CAAA,EDpCI,CAAA,IAAA,ADsCQ,CCtCR,CCoCJ,CAAA,EDpCI,ADsC8B,ECtCxB,ADsCF,EEFR,AFEsC,ECtClC,CCoCJ,IDpCe,IADf,ICqCA;AFGY,ADHhB,QCGgB,CDHhB,MCGuB,CAAC,MDHxB,OCGgB,CAAsB,KAAtB,CAA4B,OAA5B,GAAsC,MAAtC;ACtCR,ADuCK,ADhDb,CAAA,EAAA,CESQ,GDqCI,ECrCA,CAAC,GDuCM,ECvCX,GAAa,IAAb;AACA,ACmCA,AFIQ,ICvCR,ICmCM,AFIE,CCvCJ,CAAC,KCmCQ,AFIE,CAAC,EEJA,IDnChB,GAAoB,CCmCI,CAAC,EFIjB,CAAsB,KAAtB,CCvCR,ADuCoC,KEJpB,CAAwB,CFIhC,GAAsC,SAAtC,aEJQ,CAAhB;AACA,AFIK,ADlDA,OAAA,CG8CC,AH9CD,GG8CI,GAAG,KAAK,EH9CZ,GAAA,KG8CO,CAAgB,IAA5B,GH9CK;AEYR,ACmCG,AFIC,IEJD,OAAO,CAAC,GAAR,CAAY,aAAZ,EAA2B,GAA3B;;ADjCM,ACkCN,AFKA,ECvCM,MCkCF,AFKA,GELG,EFKE,GELG,GDlCN,CAAA,CDuCF,IELJ,CFKsB,CELC,EDlCjB,CAAA,KDuCN,EAAiC,ICvC3B,GAAV,YAAA;AACI,ACkCI,AFKA,MELA,AFKA,KCvCG,ECkCI,AFKA,CELC,AFKA,ECvCA,CDuCR,CAAY,GCvCT,CAAW,CCkCd,CAAkB,EDlCtB,CCkCI,CAAsB,GFKtB,KELA;ADjC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","file":"MessageBoxHandler.js","sourceRoot":"..","sourcesContent":["export class UIEventSource<T>{\n    \n    public data : T;\n    private _callbacks = [];\n\n    constructor(data: T) {\n        this.data = data;\n    }\n\n\n    public addCallback(callback: ((latestData : T) => void)) {\n        this._callbacks.push(callback);\n        return this;\n    }\n\n    public setData(t: T): void {\n        if (this.data === t) {\n            return;\n        }\n        this.data = t;\n        this.ping();\n    }\n\n    public ping(): void {\n        for (let i in this._callbacks) {\n            this._callbacks[i](this.data);\n        }\n    }\n\n    public map<J>(f: ((T) => J)): UIEventSource<J> {\n        const self = this;\n        this.addCallback(function () {\n            newSource.setData(f(self.data));\n            newSource.ping();\n        });\n        const newSource = new UIEventSource<J>(\n            f(this.data)\n        );\n\n        return newSource;\n\n    }\n\n\n}","import {UIEventSource} from \"./UIEventSource\";\nimport {Playground} from \"../Layers/Playground\";\n\nexport abstract class UIElement {\n\n    private static nextId: number = 0;\n\n    public readonly id: string;\n    public readonly _source: UIEventSource<any>;\n    \n    private _hideIfEmpty = false;\n\n    protected constructor(source: UIEventSource<any>) {\n        this.id = \"ui-element-\" + UIElement.nextId;\n        this._source = source;\n        UIElement.nextId++;\n        this.ListenTo(source);\n    }\n\n\n    protected ListenTo(source: UIEventSource<any>) {\n        if (source === undefined) {\n            return;\n        }\n        const self = this;\n        source.addCallback(() => {\n            self.Update();\n        })\n    }\n\n    private _onClick: () => void;\n\n    public onClick(f: (() => void)) {\n        this._onClick = f;\n        this.Update();\n    }\n\n    Update(): void {\n        let element = document.getElementById(this.id);\n        if (element === null || element === undefined) {\n            // The element is not painted\n            return;\n        }\n\n        element.innerHTML = this.InnerRender();\n        if (this._hideIfEmpty) {\n            if (element.innerHTML === \"\") {\n                element.parentElement.style.display = \"none\";\n            } else {\n                element.parentElement.style.display = undefined;\n            }\n        }\n\n        if (this._onClick !== undefined) {\n            console.log(\"Registering\")\n            const self = this;\n            element.onclick = () => {\n                console.log(\"Clicked!\")\n                self._onClick();\n            }\n            element.style.cursor = \"pointer\";\n        }\n\n        this.InnerUpdate(element);\n    }\n    \n    HideOnEmpty(hide : boolean){\n        this._hideIfEmpty = hide;\n        this.Update();\n        return this;\n    }\n    \n    // Called after the HTML has been replaced. Can be used for css tricks\n    InnerUpdate(htmlElement : HTMLElement){}\n\n    Render(): string {\n        return \"<span class='uielement' id='\" + this.id + \"'>\" + this.InnerRender() + \"</span>\"\n    }\n\n    AttachTo(divId: string) {\n        let element = document.getElementById(divId);\n        if(element === null){\n            console.log(\"SEVERE: could not attach UIElement to \", divId);\n            return;\n        }\n        element.innerHTML = this.Render();\n        this.Update();\n        return this;\n    }\n\n    protected abstract InnerRender(): string;\n    public Activate(): void {};\n\n    public IsEmpty(): boolean {\n        return this.InnerRender() === \"\";\n    }\n\n}","import {UIElement} from \"../UIElement\";\nimport {UIEventSource} from \"../UIEventSource\";\n\nexport class VariableUiElement extends UIElement {\n    private _html: UIEventSource<string>;\n    private _innerUpdate: (htmlElement: HTMLElement) => void;\n\n    constructor(html: UIEventSource<string>, innerUpdate : ((htmlElement : HTMLElement) => void) = undefined) {\n        super(html);\n        this._html = html;\n        this._innerUpdate = innerUpdate;\n\n    }\n\n    protected InnerRender(): string {\n        return this._html.data;\n    }\n    \n    InnerUpdate(htmlElement: HTMLElement) {\n        super.InnerUpdate(htmlElement);\n        if(this._innerUpdate !== undefined){\n            this._innerUpdate(htmlElement);\n        }\n    }\n\n\n}","/**\n * Keeps 'messagebox' and 'messageboxmobile' in sync, shows a 'close' button on the latter one\n */\nimport {UIEventSource} from \"./UIEventSource\";\nimport {UIElement} from \"./UIElement\";\nimport {VariableUiElement} from \"./Base/VariableUIElement\";\n\nexport class MessageBoxHandler {\n    private _uielement: UIEventSource<() => UIElement>;\n\n    constructor(uielement: UIEventSource<() => UIElement>,\n                onClear: (() => void)) {\n        this._uielement = uielement;\n        this.listenTo(uielement);\n        this.update();\n\n        window.onhashchange = function () {\n            if (location.hash === \"\") {\n                // No more element: back to the map!\n                uielement.setData(undefined);\n                onClear();\n            }\n        }\n\n        new VariableUiElement(new UIEventSource<string>(\"<h2>Naar de kaart</h2>\"),\n            () => {\n                document.getElementById(\"to-the-map\").onclick = function () {\n                    uielement.setData(undefined);\n                    onClear();\n                }\n            }\n        ).AttachTo(\"to-the-map\");\n\n\n    }\n\n    listenTo(uiEventSource: UIEventSource<any>) {\n        const self = this;\n        uiEventSource.addCallback(function () {\n            self.update();\n        })\n    }\n\n\n    update() {\n        const wrapper = document.getElementById(\"messagesboxmobilewrapper\");\n        const gen = this._uielement.data;\n        console.log(\"Generator: \", gen);\n        if (gen === undefined) {\n            wrapper.classList.add(\"hidden\")\n            if (location.hash !== \"\") {\n                location.hash = \"\"\n            }\n            return;\n        }\n        location.hash = \"#element\"\n        wrapper.classList.remove(\"hidden\");\n      /*  gen()\n            ?.HideOnEmpty(true)\n            ?.AttachTo(\"messagesbox\")\n            ?.Activate();*/\n\n        gen()\n            ?.HideOnEmpty(true)\n            ?.AttachTo(\"messagesboxmobile\")\n            ?.Activate();\n\n\n    }\n\n}"]}