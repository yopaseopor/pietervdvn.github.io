{"version":3,"sources":["UI/UIEventSource.ts","UI/UIElement.ts","UI/Base/VariableUIElement.ts","UI/MessageBoxHandler.ts"],"names":[],"mappings":";;;;;;AGAA;AFGA,ADHA,ICGA,ADHA,SCGA,IDHA;ACGA,ADHA;ACGA,ADHA,YCGA,ADHA;AGGA,AFSI,ADPA,IGFJ,OFSI,ADPA,QGFJ,CFSI,CAAsB,CET1B,EHEI,CAAY,ECOZ,EETJ,AFSoD,ADPhD,CGFJ,CHEuB,gBGFvB,CAAA;AFOY,ADPA,SCOA,ADPA,UAAA,ECOA,CDPa,ECOE,ADPf,KCOA;AELZ,AFQQ,ADPA,IGDR,KFQa,ADPA,ECOL,EDPA,CCOU,EDPE,IAAZ,GGDR,GAAA,IFQkC,GERlC,CAAA,KFQ2C,CAAC,MAApC,cERR,CAAA;AFSQ,ADPH,SCOQ,OAAL,GAAe,MAAf;AEPR,AFQQ,IERR,AFQQ,SAAS,CAAC,MAAV,CERR;AAAA,AFSQ,ADNG,EAAA,OCME,MDNF,CAAA,CCMH,CAAc,MAAd,CDNG,CAAA,WAAA,GAAP,UAAmB,QAAnB,EAAuD;AGH3D,AFUK,ADNG,SAAK,GGJb,OHIQ,CAAgB,IAAhB,CAAqB,QAArB;AGDJ,WAAA,iBAAA,CAAY,SAAZ,EACY,OADZ,EACiC;AAC7B,AFQM,ADRN,ECQM,OERD,EFQC,ADRC,CCQD,GDRN,IGAA,EFQM,CERY,AFQZ,QAAA,CERN,EFQJ,UAAmB,MAAnB,EAA6C;AEPzC,AFQA,ADRH,GAHM,KCWC,CERC,KFQK,GERV,CAAc,CFQC,QERf,CFQA,EAA0B;AEP1B,AFQI,SERC,MAAL;AFSC,ADRE,EAAA,aAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAAmB;AGCf,AHAA,IGAA,IHAI,EGAE,CAAC,EHAE,IAAL,KAAc,CGAlB,AHAA,EAAqB,CGAC,YAAA;AAClB,AFOJ,ADPI,QCOE,EEPE,EFOE,GAAG,GEPG,CAAC,AFOjB,IEPQ,KAAkB,EAAtB,EAA0B;AACtB,AFOR,ADPC,ICOD,MAAM,CAAC,WAAP,CAAmB,YAAA;AENX,AFOJ,MAAA,EEPI,EFOA,CAAC,MEPQ,AFOb,CEPc,OAAV,CAAkB,SAAlB;AACA,AFOP,ADRD,KCMA,GELQ,CHDH,IAAL,EGCe,CHDH,CAAZ;AGEK,AFOR,ADRG,GCAM,MDAD,IAAL;AGEC,AHDJ,GANM,EGCH;AFgBG,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAA8B;AER1B,AFSA,ADVG,EAAA,MGCC,CFSC,MDVF,CAAA,CCUH,GAAgB,CAAhB,IDVG,CAAA,CGCC,CAAA,EHDD,GAAP,YGCI,AHDJ,CGC0B,IAAI,eAAA,CAAA,aAAJ,CAA0B,wBAA1B,CAAtB,EACI,YAAA;AACI,AFQR,ADVA,MGEQ,GFQH,ADVkB,IAAA,CGEP,CAAC,AFQjB,ADVuB,GAAA,CAAA,EAAA,EAAA,GAAA,GGEf,CAAwB,CHFJ,UAA5B,CGEQ,CHFe,CGEuB,CHFvB,GAAA,EAAA,CGEf,AHFe,GGEiC,GHFxD,EAAuB,EAAA,EAAvB,EAAwC,CGEgB;AAC5C,AFQZ,ADXK,QGGO,EHHD,CCWJ,IAAP,EERqB,CAAC,AHHH,GAAA,EAAA,CAAA,CGGP,CAAkB,AHHX,CAAd,QGGO;AD3BpB,AC4BoB,AFQf,ADXO,GCOD,CChCX,EFyBY,EGGQ,MHHA,CEzBpB,AC4B2B,AHHN,GEzBrB,EFyB0B,IAAN,CEzBpB,AFyBY,CEzBZ,cAAA,CAAA;AC6BiB,AHHR,OGAO;ADvBhB,AC2Ba,AFQT,ADXC,ECWD,CDfO,CEpBX,CCqBQ,EAOE,IFON,CAAA,GEdI,CAOW,KD5BnB,ADmCI,CAAA,MEdI,AFcJ,GAAA,YAAA;ACnCJ,AC+BK,AFKG,QAAI,OAAO,GAAG,QAAQ,CAAC,cAAT,CAAwB,KAAK,EAA7B,CAAd;ACpCR,AF0BW,EAAA,QE1BX,KF0BW,CE1BX,AF0BW,EE1BX,OF0BW,CAAA,GAAA,GAAP,UAAc,CAAd,EAA2B;AE1BQ,ACiCnC,AFII,ADVA,EE3B+B,ACiCnC,MFIQ,ADVE,GE3ByB,CAAA,AF2BrB,GCUC,ADVE,IGMjB,AHNI,CGMJ,AFIoB,IAAZ,IAAoB,CCrCO,ACiCnC,CAAA,CDjCmC,IDqCA,ECrCA,CAAA,ACiCnC,EFIwC,CEJxC,QFII,EEJK,AFI0C,aEJnD,EAA0C;AACtC,AFII,ADVJ,QGMM,CHND,GGMK,GAAG,IAAb,CHNA,CAAiB,YAAA;AExBrB,AC+BI,AFII,ADVA,IGMJ,EHNI,KEzBR,IFyBiB,CAAC,CGMD,CAAC,KHNV,CAAkB,CAAC,CAAC,EEzB5B,CAAY,AC+BR,CAA0B,AHNE,CAAC,EEzBjC,EAAyC,AFyBd,CAAnB,MGMsB,ID/B9B,EAAwG;AAA/D,ACgCjC,AFIH,ADVG,MGMA,AHNA,EE1BiC,ECgC7B,CAAC,IHNI,CAAC,CGMV,EDhCiC,CF0BjC,IE1BiC,KAAA,CAAA,EAAA;AAAA,ACiCpC,AHNA,KGID,AHPA,CExBqC,WAAA,GAAA,SAAA;AAA+D,ACkCvG,AFIG,ADVA,GGCJ,CFSI,IDVM,GCUC,CAAC,KDVO,GAAG,CCUlB,GAAoB,ADVE,KCUG,QDVP,CACd,CAAC,CCSe,ADTd,ECSN,GDTW,IAAN,CADa,CAAlB;AAIA,WAAO,SAAP;AEhCJ,ACqCA,AFEI,ADLH,EGGD,CHfO,KEtBP,ADuCQ,KCvCR,ADuCa,GCtCT,GCoCJ,CAAA,EDpCI,CAAA,EDsCA,ECtCA,ADsCuB,CCtCvB,CCoCJ,CAAA,EDpCI,EAAM,ECoCV,EDpCI,CCoCJ,IDpCe,IADf,ICqCA;AFGQ,UAAI,OAAO,CAAC,SAAR,KAAsB,EAA1B,EAA8B;ACtClC,ADuCQ,ADJhB,IEnCQ,IDuCQ,CCvCJ,AFmCZ,CEnCa,KAAL,ADuCe,CAAC,ECvCH,IAAb,AFmCR,OCIgB,CAAsB,KAAtB,CAA4B,OAA5B,GAAsC,MAAtC;ACtCR,ACmCA,AFIK,ADjDb,CAAA,EAAA,CEUQ,GDqCI,CEFE,CDnCF,CAAC,GDuCM,EEJE,GAAG,IDnChB,GAAoB,CCmCI,CAAC,SDnCzB,KCmCgB,CAAwB,0BAAxB,CAAhB;AACA,AFIQ,QEJF,AFIE,GEJC,GAAG,CFIG,CAAC,GEJC,UAAL,AFIJ,CEJoB,AFIE,IEJ9B,CFIQ,CAA4B,OAA5B,GAAsC,SAAtC;ACtCX,ACmCG,AFIK,ADnDA,IG+CL,GH/CK,CAAA,GG+CE,CAAC,GAAR,CAAY,KH/CP,GAAA,KG+CL,EAA2B,GAA3B,GH/CK;ACoDJ;ACtCK,ACkCN,EDlCM,MCkCF,GAAG,KAAK,GDlCN,CAAA,KCkCN,EAAuB,EDlCjB,CAAA,WAAA,GAAV,YAAA;AACI,ACkCI,AFKJ,MELI,EFKA,GCvCG,ECkCI,AFKF,CELG,ED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","file":"MessageBoxHandler.js","sourceRoot":"..","sourcesContent":["export class UIEventSource<T>{\n    \n    public data : T;\n    private _callbacks = [];\n\n    constructor(data: T) {\n        this.data = data;\n    }\n\n\n    public addCallback(callback: ((latestData : T) => void)) {\n        this._callbacks.push(callback);\n        return this;\n    }\n\n    public setData(t: T): void {\n        if (this.data === t) {\n            return;\n        }\n        this.data = t;\n        this.ping();\n    }\n\n    public ping(): void {\n        for (const callback of this._callbacks) {\n            callback(this.data);\n        }\n    }\n\n    public map<J>(f: ((T) => J)): UIEventSource<J> {\n        const self = this;\n        this.addCallback(function () {\n            newSource.setData(f(self.data));\n            newSource.ping();\n        });\n        const newSource = new UIEventSource<J>(\n            f(this.data)\n        );\n\n        return newSource;\n\n    }\n\n\n}","import {UIEventSource} from \"./UIEventSource\";\nimport {Playground} from \"../Layers/Playground\";\n\nexport abstract class UIElement {\n\n    private static nextId: number = 0;\n\n    public readonly id: string;\n    public readonly _source: UIEventSource<any>;\n    \n    private _hideIfEmpty = false;\n\n    protected constructor(source: UIEventSource<any>) {\n        this.id = \"ui-element-\" + UIElement.nextId;\n        this._source = source;\n        UIElement.nextId++;\n        this.ListenTo(source);\n    }\n\n\n    protected ListenTo(source: UIEventSource<any>) {\n        if (source === undefined) {\n            return;\n        }\n        const self = this;\n        source.addCallback(() => {\n            self.Update();\n        })\n    }\n\n    private _onClick: () => void;\n\n    public onClick(f: (() => void)) {\n        this._onClick = f;\n        this.Update();\n        return this;\n    }\n\n    Update(): void {\n        let element = document.getElementById(this.id);\n        if (element === null || element === undefined) {\n            // The element is not painted\n            return;\n        }\n\n        element.innerHTML = this.InnerRender();\n        if (this._hideIfEmpty) {\n            if (element.innerHTML === \"\") {\n                element.parentElement.style.display = \"none\";\n            } else {\n                element.parentElement.style.display = undefined;\n            }\n        }\n\n        if (this._onClick !== undefined) {\n            const self = this;\n            element.onclick = () => {\n                self._onClick();\n            }\n            element.style.pointerEvents = \"all\";\n            element.style.cursor = \"pointer\";\n        }\n\n        this.InnerUpdate(element);\n    }\n    \n    HideOnEmpty(hide : boolean){\n        this._hideIfEmpty = hide;\n        this.Update();\n        return this;\n    }\n    \n    // Called after the HTML has been replaced. Can be used for css tricks\n    InnerUpdate(htmlElement : HTMLElement){}\n\n    Render(): string {\n        return \"<span class='uielement' id='\" + this.id + \"'>\" + this.InnerRender() + \"</span>\"\n    }\n\n    AttachTo(divId: string) {\n        let element = document.getElementById(divId);\n        if(element === null){\n            console.log(\"SEVERE: could not attach UIElement to \", divId);\n            return;\n        }\n        element.innerHTML = this.Render();\n        this.Update();\n        return this;\n    }\n\n    protected abstract InnerRender(): string;\n    public Activate(): void {};\n\n    public IsEmpty(): boolean {\n        return this.InnerRender() === \"\";\n    }\n\n}","import {UIElement} from \"../UIElement\";\nimport {UIEventSource} from \"../UIEventSource\";\n\nexport class VariableUiElement extends UIElement {\n    private _html: UIEventSource<string>;\n    private _innerUpdate: (htmlElement: HTMLElement) => void;\n\n    constructor(html: UIEventSource<string>, innerUpdate : ((htmlElement : HTMLElement) => void) = undefined) {\n        super(html);\n        this._html = html;\n        this._innerUpdate = innerUpdate;\n\n    }\n\n    protected InnerRender(): string {\n        return this._html.data;\n    }\n    \n    InnerUpdate(htmlElement: HTMLElement) {\n        super.InnerUpdate(htmlElement);\n        if(this._innerUpdate !== undefined){\n            this._innerUpdate(htmlElement);\n        }\n    }\n\n\n}","/**\n * Keeps 'messagebox' and 'messageboxmobile' in sync, shows a 'close' button on the latter one\n */\nimport {UIEventSource} from \"./UIEventSource\";\nimport {UIElement} from \"./UIElement\";\nimport {VariableUiElement} from \"./Base/VariableUIElement\";\n\nexport class MessageBoxHandler {\n    private _uielement: UIEventSource<() => UIElement>;\n\n    constructor(uielement: UIEventSource<() => UIElement>,\n                onClear: (() => void)) {\n        this._uielement = uielement;\n        this.listenTo(uielement);\n        this.update();\n\n        window.onhashchange = function () {\n            if (location.hash === \"\") {\n                // No more element: back to the map!\n                uielement.setData(undefined);\n                onClear();\n            }\n        }\n\n        new VariableUiElement(new UIEventSource<string>(\"<h2>Naar de kaart</h2>\"),\n            () => {\n                document.getElementById(\"to-the-map\").onclick = function () {\n                    uielement.setData(undefined);\n                    onClear();\n                }\n            }\n        ).AttachTo(\"to-the-map\");\n\n\n    }\n\n    listenTo(uiEventSource: UIEventSource<any>) {\n        const self = this;\n        uiEventSource.addCallback(function () {\n            self.update();\n        })\n    }\n\n\n    update() {\n        const wrapper = document.getElementById(\"messagesboxmobilewrapper\");\n        const gen = this._uielement.data;\n        console.log(\"Generator: \", gen);\n        if (gen === undefined) {\n            wrapper.classList.add(\"hidden\")\n            if (location.hash !== \"\") {\n                location.hash = \"\"\n            }\n            return;\n        }\n        location.hash = \"#element\"\n        wrapper.classList.remove(\"hidden\");\n      /*  gen()\n            ?.HideOnEmpty(true)\n            ?.AttachTo(\"messagesbox\")\n            ?.Activate();*/\n\n        gen()\n            ?.HideOnEmpty(true)\n            ?.AttachTo(\"messagesboxmobile\")\n            ?.Activate();\n\n\n    }\n\n}"]}