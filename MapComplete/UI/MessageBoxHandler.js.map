{"version":3,"sources":["UI/UIEventSource.ts","UI/UIElement.ts","UI/Base/VariableUIElement.ts","UI/MessageBoxHandler.ts"],"names":[],"mappings":";;;;;;AGAA;AFEA,ADFA,ICEA,ADFA,SCEA,IDFA;ACEA,ADFA;ACEA,ADFA,YCEA,ADFA;AGGA,AFQI,ADNA,IGFJ,OFQI,ADNA,QGFJ,CFQI,CAAsB,CER1B,EHEI,CAAY,ECMZ,EERJ,AFQoD,ADNhD,CGFJ,CHEuB,gBGFvB,CAAA;AFMY,ADNA,SCMA,ADNA,UAAA,ECMA,CDNa,ECME,ADNf,KCMA;AEJZ,AFOQ,ADNA,IGDR,KFOa,ADNA,ECML,EDNA,CCMU,EDNE,IAAZ,GGDR,GAAA,IFOkC,GEPlC,CAAA,KFO2C,CAAC,MAApC,cEPR,CAAA;AFQQ,ADNH,SCMQ,OAAL,GAAe,MAAf;AENR,AFOQ,IEPR,AFOQ,SAAS,CAAC,MAAV,CEPR;AAAA,AFQQ,ADLG,EAAA,OCKE,MDLF,CAAA,CCKH,CAAc,MAAd,CDLG,CAAA,WAAA,GAAP,UAAmB,QAAnB,EAAuD;AGH3D,AFSK,ADLG,SAAK,GGJb,OHIQ,CAAgB,IAAhB,CAAqB,QAArB;AGDJ,WAAA,iBAAA,CAAY,SAAZ,EACY,OADZ,EACiC;AAC7B,AFOG,ADPH,ECOG,OEPE,EFOF,ADPI,CCOJ,GDPH,IGAA,EFOG,CEPe,AFOf,QAAA,CEPH,EFOJ,UAAgB,MAAhB,EAA0C;AENtC,AFOA,ADPH,GAHM,KCUC,CEPC,KFOK,GEPV,CAAc,CFOC,QEPf,CFOA,EAA0B;AEN1B,AFOI,SEPC,MAAL;AFQC,ADPE,EAAA,aAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAAmB;AGCf,AHAA,IGAA,IHAI,EGAE,CAAC,EHAE,IAAL,KAAc,CGAlB,AHAA,EAAqB,CGAC,YAAA;AAClB,AFMJ,ADNI,QCME,EENE,EFME,GAAG,GENG,CAAC,AFMjB,IENQ,KAAkB,EAAtB,EAA0B;AACtB,AFMR,ADNC,ICMD,MAAM,CAAC,WAAP,CAAmB,YAAA;AELX,AFMJ,MAAA,EENI,EFMA,CAAC,MENQ,AFMb,CENc,OAAV,CAAkB,SAAlB;AACA,AFMP,ADPD,KCKA,GEJQ,CHDH,IAAL,EGCe,CHDH,CAAZ;AGEK,AFMR,ADPG,GCDG,MDCE,IAAL;AGEC,AHDJ,GANM,EGCH;AFeG,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAA8B;AEP1B,AFQA,ADTG,EAAA,MGCC,CFQC,MDTF,CAAA,CCSH,GAAgB,CAAhB,IDTG,CAAA,CGCC,CAAA,EHDD,GAAP,YGCI,AHDJ,CGC0B,IAAI,eAAA,CAAA,aAAJ,CAA0B,wBAA1B,CAAtB,EACI,YAAA;AACI,AFOR,ADTA,MGEQ,GFOH,ADTkB,IAAA,CGEP,CAAC,AFOjB,ADTuB,GAAA,CAAA,EAAA,EAAA,GAAA,GGEf,CAAwB,CHFJ,UAA5B,CGEQ,CHFe,CGEuB,CHFvB,GAAA,EAAA,CGEf,AHFe,GGEiC,GHFxD,EAAuB,EAAA,EAAvB,EAAwC,CGEgB;AAC5C,AFOZ,ADVK,QGGO,EHHD,CCUJ,IAAP,EEPqB,CAAC,AHHH,GAAA,EAAA,CAAA,CGGP,CAAkB,AHHX,CAAd,QGGO;AD3BpB,AC4BoB,AFOf,ADVO,GCMD,CC/BX,EFyBY,EGGQ,MHHA,CEzBpB,AC4B2B,AHHN,GEzBrB,EFyB0B,IAAN,CEzBpB,AFyBY,CEzBZ,cAAA,CAAA;AC6BiB,AHHR,OGAO;ADvBhB,AC2Ba,AFOT,ADVC,ECUD,CDdO,CEpBX,CCqBQ,EAOE,IFMN,CAAA,GEbI,CAOW,KD5BnB,ADkCI,CAAA,MEbI,AFaJ,GAAA,YAAA;AClCJ,AC+BK,AFIG,QAAI,OAAO,GAAG,QAAQ,CAAC,cAAT,CAAwB,KAAK,EAA7B,CAAd;ACnCR,AF0BW,EAAA,QE1BX,KF0BW,CE1BX,AF0BW,EE1BX,OF0BW,CAAA,GAAA,GAAP,UAAc,CAAd,EACc,YADd,EACsD;AE3BnB,ACiCnC,AFGI,ADTU,EE3BqB,ACiCnC,MFGQ,ADTM,GE3BqB,CAAA,GDoCpB,IEHf,CAAA,AFGoB,ADTN,ICSN,CDTM,GCSc,CCpCO,ACiCnC,CAAA,AHNc,CE3BqB,AF2BrB,EAAA,ECSqB,ECpCA,CAAA,ACiCnC,EFGwC,CEHxC,QFGI,EEHK,AFG0C,aEHnD,EAA0C;AACtC,AFGI,ADVM,MAAA,EGOJ,IAAI,GAAG,GHPH,CGOV,EHPU,EAAA;AEvBd,AC+BI,AFGI,ADX8C,IGQlD,OD/BJ,MC+BiB,CAAC,UD/BlB,CAAY,AC+BR,CAA0B,GD/B9B,EAAyC,OC+BX,ID/B9B,EAAwG;AAA/D,ACgCjC,AFGH,MEHG,EDhCiC,ECgC7B,CAAC,MAAL,EDhCiC,KAAA,KAAA,CAAA,EAAA;AAAA,ACiCpC,AHTD,KGOA,CD/BqC,EFwB/B,IAAI,GAAG,EExBwB,EFwBrC,CExBqC,SAAA;AAA+D,ACkCvG,AFGG,GERJ,CFQI,OAAO,CAAC,SAAR,GAAoB,KAAK,WAAL,EAApB;ADXA,QAAM,MAAM,GAAG,SAAT,MAAS,GAAA;AE1BnB,ACqCA,AFCI,ADXI,EGUR,IHVQ,EE3BR,ADsCQ,KCtCR,ADsCa,EDXI,CE1Bb,AF0Bc,GGUlB,CAAA,EDpCI,CAAA,AF0BI,CAAkB,CCWtB,ADXuB,CAAC,CE1BxB,ADqCuB,CCrCvB,CCoCJ,CAAA,AHVgC,CAAC,CE1B7B,EAAM,CF0BiB,CGU3B,AHVQ,EE1BJ,CCoCJ,IDpCe,IADf,ICqCA;AFEQ,ADXA,MAAA,ICWI,KDXK,CAAC,CCWC,CAAC,EDXZ,OCWI,KAAsB,EAA1B,EAA8B;ACrClC,ADsCQ,ADXP,IE3BD,CFwBA,GCcQ,CCtCJ,CAAC,KAAL,ADsCe,CAAC,ECtCH,IAAb,ODsCQ,CAAsB,KAAtB,CAA4B,OAA5B,GAAsC,MAAtC;ACrCR,ACmCA,AFGK,ICtCL,GDoCI,CEDE,CDnCF,CAAC,GDsCM,EEHE,GAAG,IDnChB,GAAoB,CCmCI,CAAC,SDnCzB,KCmCgB,CAAwB,0BAAxB,CAAhB;AACA,AFGQ,ADXR,QGQM,AFGE,CDXH,EGQI,GAAG,CFGG,CAAC,GEHC,CHRjB,CAAiB,MAAjB,EGQY,AFGJ,CEHoB,AFGE,IEH9B,CFGQ,CAA4B,OAA5B,GAAsC,SAAtC;ACrCX,ACmCG,AFGK,IEHL,OAAO,CAAC,GAAR,CAAY,aAAZ,EAA2B,GAA3B;AFIC,ADZD,SAA0B,IAAA,EAAA,GAAA,CAAA,EAAA,cAAA,GAAA,YAA1B,EAA0B,EAAA,GAAA,cAAA,CAAA,MAA1B,EAA0B,EAAA,EAA1B,EAAwC;AEzBlC,ACkCN,AHTK,EEzBC,MCkCF,EHTO,CGSJ,KAAK,GDlCN,CAAA,CFyBgB,GAAA,CGStB,EAAuB,EDlCjB,CAAA,QFyBgB,CAAA,EEzBhB,AFyBgB,CAAjB,EEzBT,YAAA;AACI,ACkCI,AFIJ,ADbI,MGSA,AHTA,ECaA,GCtCG,ECkCI,AFIF,CEJG,EDlCA,CFyBG,CAAC,GEzBT,ADsCH,CCtCc,CCkCd,CAAkB,EDlCtB,ADsCsB,CEJlB,CAAsB,CHTtB,CAAwB,KCa5B,CEJI,AHTA,CCa6B;ACrCpC,ADsCO,ADbH,GE3BK,ODwCI,MAAI,GAAG,IAAb;AEJA,UAAI,QAAQ,CAAC,IAAT,KAAkB,EAAtB,EAA0B;ADhClC,ACiCY,AFIJ,ADbJ,EExBJ,IDqCQ,EEJI,AHTF,KCaK,CAAC,EEJI,CAAC,AHTF,EExBnB,CAAA,AFwBsB,CGSV,AFIJ,GEJoB,AFIF,ADbA,EGSd,GDjCZ,CAAA,MDqC0B,CDbJ,CACd,CAAC,CAAC,CEzBV,GAAA,CFyBe,IAAN,CADa,CAAlB,GExBQ,WAAZ,EAAoC;AAChC,ACiCK,AFIG,ADTR,IE5BA,IDqCQ,ECrCR,CAAA,AF4BO,GCSK,CAAC,KCrCb,AF4BA,CE5BM,EDqCE,SCrCR,CAAiB,IAAjB,CAAiB,IAAjB,EAAkB,WAAlB;ADsCK,ADRR,GApBM,IC0BC;ACnCJ,ACiCI,QDjCD,KAAK,YAAL,KAAsB,SAAzB,EAAmC;AAC/B,ACiCH,AFIG,ADNZ,MCMY,GDNZ,EE/BiB,EDqCE,CAAC,KAAR,CAAc,EDN1B,CE/BY,CAAkB,SDqClB,ECrCA,CDqC8B,KAA9B;ACpCH,ADqCG,AD3DZ,CAAA,EAAA,GC2DY,OAAO,CAAC,KAAR,CAAc,MAAd,GAAuB,SAAvB;ACpCP,ACgCG,AFKG,GC1CP,CCqCI,QAAQ,CAAC,IAAT,GAAgB,UAAhB;AACA,AHxDK,IGwDL,GHxDK,CAAA,GGwDE,CAAC,SAAR,AHxDK,CGwDa,EHxDb,IGwDL,CAAyB,QAAzB,AHxDK;AE0Bb,AC+BM,SD/BN,iBAAA;AAvBA,CAAA,CAAuC,WAAA,CAAA,SAAvC,CAAA;;AAAa,OAAA,CAAA,iBAAA,GAAA,iBAAA;;AC2DL,KAAA,EAAA,GAAA,CAAA,EAAA,GAAA,CAAA,EAAA,GAAA,GAAG,EAAH,MAAK,IAAL,IAAK,EAAA,KAAA,KAAA,CAAL,GAAK,KAAA,CAAL,GAAK,EAAA,CACC,WADD,CACa,IADb,CAAL,MACsB,IADtB,IACsB,EAAA,KAAA,KAAA,CADtB,GACsB,KAAA,CADtB,GACsB,EAAA,CAChB,QADgB,CACP,mBADO,CADtB,MAEkC,IAFlC,IAEkC,EAAA,KAAA,KAAA,CAFlC,GAEkC,KAAA,CAFlC,GAEkC,EAAA,CAC5B,QAD4B,EAFlC;AAMH,GAxBD;;AA0BJ,SAAA,iBAAA;AA/DA,AFgES,CEhET,EAAA;;AAAa,AFkEL,OElEK,CAAA,CFkEA,WAAL,CAAiB,IElEZ,GAAA,AFkEL,iBElEK;AFmER,GArCD;;AAuCA,EAAA,SAAA,CAAA,SAAA,CAAA,WAAA,GAAA,UAAY,IAAZ,EAA0B;AACtB,SAAK,YAAL,GAAoB,IAApB;AACA,SAAK,MAAL;AACA,WAAO,IAAP;AACH,GAJD,CA1EJ,CAgFI;;;AACA,EAAA,SAAA,CAAA,SAAA,CAAA,WAAA,GAAA,UAAY,WAAZ,EAAqC,CAAG,CAAxC;;AAEA,EAAA,SAAA,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AACI,WAAO,iCAAiC,KAAK,EAAtC,GAA2C,IAA3C,GAAkD,KAAK,WAAL,EAAlD,GAAuE,SAA9E;AACH,GAFD;;AAIA,EAAA,SAAA,CAAA,SAAA,CAAA,QAAA,GAAA,UAAS,KAAT,EAAsB;AAClB,QAAI,OAAO,GAAG,QAAQ,CAAC,cAAT,CAAwB,KAAxB,CAAd;;AACA,QAAG,OAAO,KAAK,IAAf,EAAoB;AAChB,MAAA,OAAO,CAAC,GAAR,CAAY,wCAAZ,EAAsD,KAAtD;AACA;AACH;;AACD,IAAA,OAAO,CAAC,SAAR,GAAoB,KAAK,MAAL,EAApB;AACA,SAAK,MAAL;AACA,WAAO,IAAP;AACH,GATD;;AAYO,EAAA,SAAA,CAAA,SAAA,CAAA,QAAA,GAAP,YAAA,CAA0B,CAAnB;;AAAmB;;AAEnB,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,YAAA;AACI,WAAO,KAAK,WAAL,OAAuB,EAA9B;AACH,GAFM;;AAnGQ,EAAA,SAAA,CAAA,MAAA,GAAiB,CAAjB;AAuGnB,SAAA,SAAA;AAzGA,CAAA,EAAA;;AAAsB,OAAA,CAAA,SAAA,GAAA,SAAA","file":"MessageBoxHandler.js","sourceRoot":"..","sourcesContent":["export class UIEventSource<T>{\n    \n    public data : T;\n    private _callbacks = [];\n\n    constructor(data: T) {\n        this.data = data;\n    }\n\n\n    public addCallback(callback: ((latestData : T) => void)) {\n        this._callbacks.push(callback);\n        return this;\n    }\n\n    public setData(t: T): void {\n        if (this.data === t) {\n            return;\n        }\n        this.data = t;\n        this.ping();\n    }\n\n    public ping(): void {\n        for (const callback of this._callbacks) {\n            callback(this.data);\n        }\n    }\n\n    public map<J>(f: ((T) => J),\n                  extraSources : UIEventSource<any>[] = []): UIEventSource<J> {\n        const self = this;\n        \n        const update = function () {\n            newSource.setData(f(self.data));\n            newSource.ping();\n        }\n        \n        this.addCallback(update);\n        for (const extraSource of extraSources) {\n            extraSource.addCallback(update);\n        }\n        const newSource = new UIEventSource<J>(\n            f(this.data)\n        );\n        \n\n        return newSource;\n\n    }\n\n\n}","import {UIEventSource} from \"./UIEventSource\";\n\nexport abstract class UIElement {\n\n    private static nextId: number = 0;\n\n    public readonly id: string;\n    public readonly _source: UIEventSource<any>;\n    \n    private _hideIfEmpty = false;\n\n    protected constructor(source: UIEventSource<any>) {\n        this.id = \"ui-element-\" + UIElement.nextId;\n        this._source = source;\n        UIElement.nextId++;\n        this.ListenTo(source);\n    }\n\n\n    public ListenTo(source: UIEventSource<any>) {\n        if (source === undefined) {\n            return;\n        }\n        const self = this;\n        source.addCallback(() => {\n            self.Update();\n        })\n    }\n\n    private _onClick: () => void;\n\n    public onClick(f: (() => void)) {\n        this._onClick = f;\n        this.Update();\n        return this;\n    }\n\n    Update(): void {\n        let element = document.getElementById(this.id);\n        if (element === null || element === undefined) {\n            // The element is not painted\n            return;\n        }\n\n        element.innerHTML = this.InnerRender();\n        if (this._hideIfEmpty) {\n            if (element.innerHTML === \"\") {\n                element.parentElement.style.display = \"none\";\n            } else {\n                element.parentElement.style.display = undefined;\n            }\n        }\n\n        if (this._onClick !== undefined) {\n            const self = this;\n            element.onclick = () => {\n                self._onClick();\n            }\n            element.style.pointerEvents = \"all\";\n            element.style.cursor = \"pointer\";\n           /*\n            const childs = element.children;\n            for (let i = 0; i < childs.length; i++) {\n                const ch = childs[i];\n                console.log(ch);\n                ch.style.cursor = \"pointer\";\n                ch.onclick = () => {\n                    self._onClick();\n                }\n                ch.style.pointerEvents = \"all\";\n            }*/\n        }\n\n        this.InnerUpdate(element);\n    }\n    \n    HideOnEmpty(hide : boolean){\n        this._hideIfEmpty = hide;\n        this.Update();\n        return this;\n    }\n    \n    // Called after the HTML has been replaced. Can be used for css tricks\n    InnerUpdate(htmlElement : HTMLElement){}\n\n    Render(): string {\n        return \"<span class='uielement' id='\" + this.id + \"'>\" + this.InnerRender() + \"</span>\"\n    }\n\n    AttachTo(divId: string) {\n        let element = document.getElementById(divId);\n        if(element === null){\n            console.log(\"SEVERE: could not attach UIElement to \", divId);\n            return;\n        }\n        element.innerHTML = this.Render();\n        this.Update();\n        return this;\n    }\n\n    protected abstract InnerRender(): string;\n    public Activate(): void {};\n\n    public IsEmpty(): boolean {\n        return this.InnerRender() === \"\";\n    }\n\n}","import {UIElement} from \"../UIElement\";\nimport {UIEventSource} from \"../UIEventSource\";\n\nexport class VariableUiElement extends UIElement {\n    private _html: UIEventSource<string>;\n    private _innerUpdate: (htmlElement: HTMLElement) => void;\n\n    constructor(html: UIEventSource<string>, innerUpdate : ((htmlElement : HTMLElement) => void) = undefined) {\n        super(html);\n        this._html = html;\n        this._innerUpdate = innerUpdate;\n\n    }\n\n    protected InnerRender(): string {\n        return this._html.data;\n    }\n    \n    InnerUpdate(htmlElement: HTMLElement) {\n        super.InnerUpdate(htmlElement);\n        if(this._innerUpdate !== undefined){\n            this._innerUpdate(htmlElement);\n        }\n    }\n\n\n}","/**\n * Keeps 'messagebox' and 'messageboxmobile' in sync, shows a 'close' button on the latter one\n */\nimport {UIEventSource} from \"./UIEventSource\";\nimport {UIElement} from \"./UIElement\";\nimport {VariableUiElement} from \"./Base/VariableUIElement\";\n\nexport class MessageBoxHandler {\n    private _uielement: UIEventSource<() => UIElement>;\n\n    constructor(uielement: UIEventSource<() => UIElement>,\n                onClear: (() => void)) {\n        this._uielement = uielement;\n        this.listenTo(uielement);\n        this.update();\n\n        window.onhashchange = function () {\n            if (location.hash === \"\") {\n                // No more element: back to the map!\n                uielement.setData(undefined);\n                onClear();\n            }\n        }\n\n        new VariableUiElement(new UIEventSource<string>(\"<h2>Naar de kaart</h2>\"),\n            () => {\n                document.getElementById(\"to-the-map\").onclick = function () {\n                    uielement.setData(undefined);\n                    onClear();\n                }\n            }\n        ).AttachTo(\"to-the-map\");\n\n\n    }\n\n    listenTo(uiEventSource: UIEventSource<any>) {\n        const self = this;\n        uiEventSource.addCallback(function () {\n            self.update();\n        })\n    }\n\n\n    update() {\n        const wrapper = document.getElementById(\"messagesboxmobilewrapper\");\n        const gen = this._uielement.data;\n        console.log(\"Generator: \", gen);\n        if (gen === undefined) {\n            wrapper.classList.add(\"hidden\")\n            if (location.hash !== \"\") {\n                location.hash = \"\"\n            }\n            return;\n        }\n        location.hash = \"#element\"\n        wrapper.classList.remove(\"hidden\");\n      /*  gen()\n            ?.HideOnEmpty(true)\n            ?.AttachTo(\"messagesbox\")\n            ?.Activate();*/\n\n        gen()\n            ?.HideOnEmpty(true)\n            ?.AttachTo(\"messagesboxmobile\")\n            ?.Activate();\n\n\n    }\n\n}"]}