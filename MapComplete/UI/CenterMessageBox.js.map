{"version":3,"sources":["UI/UIElement.ts","UI/UIEventSource.ts","UI/CenterMessageBox.ts"],"names":[],"mappings":";;;;;;;AAGA,ACHA,IDGA,ACHA,SDGA,ICHA;ADGA,ACHA;ADGA,ACHA,YDGA,ACHA;ADYI,ACPA,WDOA,ACPA,SDOA,CAAsB,GCPtB,CAAY,EDOZ,EAAgD,ACPhD,EAAmB;ADKX,ACPA,SDOA,ACPA,UAAA,EDOA,CCPa,EDOE,ACPf,KDOA;AAGJ,ACPA,SDOK,ACPA,EDOL,ECPA,CDOU,ECPE,IAAZ,UDO0B,SAAS,CAAC,MAApC;AACA,ACPH,SDOQ,OAAL,GAAe,MAAf;AACA,IAAA,SAAS,CAAC,MAAV;AACA,ACNG,EAAA,ODME,MCNF,CAAA,CDMH,CAAc,MAAd,CCNG,CAAA,WAAA,GAAP,UAAmB,QAAnB,EAAuD;ADOtD,ACNG,SAAK,UAAL,CAAgB,IAAhB,CAAqB,QAArB;;ADSM,ACRN,EDQM,SAAA,ACRC,CDQD,GCRN,MDQM,CAAA,QAAA,GAAV,UAAmB,MAAnB,EAA6C;AACzC,ACRH,GAHM,KDWC,MAAM,KAAK,SAAf,EAA0B;AACtB;AACH,ACRE,EAAA,aAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAAmB;AACf,QAAI,KAAK,IAAL,KAAc,CAAlB,EAAqB;ADQrB,ACPI,QDOE,IAAI,GAAG,IAAb;AACA,ACPC,IDOD,MAAM,CAAC,WAAP,CAAmB,YAAA;AACf,MAAA,IAAI,CAAC,MAAL;AACH,ACRD,KDMA,ICNK,IAAL,GAAY,CAAZ;ADSH,ACRG,GDAM,MCAD,IAAL;AACH,GANM;ADiBA,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAA8B;AAC1B,ACVG,EAAA,ODUE,MCVF,CAAA,CDUH,GAAgB,CAAhB,ICVG,CAAA,IAAA,GAAP,YAAA;ADWI,ACVA,SDUK,ACVkB,IAAA,EDUvB,ACVuB,GAAA,CAAA,EAAA,EAAA,GAAA,KAAK,UAA5B,EAAuB,EAAA,GAAA,EAAA,CAAA,MAAvB,EAAuB,EAAA,EAAvB,EAAwC;ADWxC,ACXK,UAAM,CDWJ,IAAP,GCXmB,GAAA,EAAA,CAAA,EAAA,CAAd;ACxBb,AFoCK,ACXO,GDOD,CEhCX,EDyBY,QAAQ,CCzBpB,ADyBqB,GCzBrB,EDyB0B,IAAN,CCzBpB,ADyBY,CCzBZ,aAAA,CAAA;AD0BS;ACzBT,AFqCI,ACXC,EDWD,CCfO,CCtBX,OFqCI,CAAA,OErCJ,EFqCI,CErCJ,AFqCI,MAAA,CErCJ,CAAA,CFqCI,YAAA,IErCJ,CAAA;AFsCQ,QAAI,OAAO,GAAG,QAAQ,CAAC,cAAT,CAAwB,KAAK,EAA7B,CAAd;AEnCR,ADyBW,EAAA,ECzBX,WDyBW,CAAA,ICzBX,KDyBW,CAAA,GAAA,GAAP,UAAc,CAAd,EAA2B;ACzB/B,AFoCQ,ACVA,QDUI,ACVE,IAAI,GDUC,ACVE,IAAb,CDUgB,IAAZ,IAAoB,OAAO,KAAK,SAApC,EAA+C;AEpCvD,AFqCY,ACVJ,SAAK,CC3Bb,MAAA,EAAA,ED2BQ,CAAiB,YAAA;AC3Ba,AFsC1B,ACVA,EC5B0B,ID4B1B,KC5B0B,CAAA,GD4BjB,CAAC,OAAV,CAAkB,CAAC,CAAC,EC5BM,EAAA,AD4BF,CAAC,IAAN,CC5BO,AD4B1B,CC5B0B;AFuC7B,ACVG,MAAA,SAAS,CAAC,IAAV;ACrBR,ADsBK,KAHD,MCnBJ,gBAAA,CACI,SADJ,EAEI,aAFJ,EAGI,aAHJ,EAII,QAJJ,EAKI,YALJ,EAKwC;AALxC,AFiCI,ACVA,IDUA,IEjCJ,ADuBU,GDUC,CAAC,CEjCZ,GAOI,CDgBe,GAAG,CDUlB,CE1BA,CAAA,CF0BoB,ACVE,GChBtB,CAAA,CF0ByB,GE1BzB,EAAM,GDgBY,CACd,CAAC,CDSe,ACTd,EDSN,GCTW,ECjBX,EDiBK,CADa,CAAlB,CChBoB,IAPxB;AD2BI,WAAO,SAAP;AChCa,AFuCb,ACLH,GAZM,CCtBU,IFuCT,CEvCS,CAAA,GFuCJ,QEvCI,GAAc,CFuC3B,EAAuB,CEvCQ,eAAA,CAAA,aAAJ,CAA2B,IAA3B,CAAd;AAcb,AF0BI,IE1BJ,KAAI,CAAC,AF0BG,OAAO,CAAC,ME1BhB,GAAsB,AF0Bd,KAAsB,EAA1B,EAA8B,IE1BlC;AACA,AF0BQ,ACJhB,ICtBQ,IF0BQ,CE1BJ,ADsBZ,CCtBa,KF0BU,CAAC,GE1BhB,GAAiB,ADsBzB,ODIgB,CE1BR,AF0B8B,KAAtB,CAA4B,OAA5B,GAAs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","file":"CenterMessageBox.js","sourceRoot":"..","sourcesContent":["import {UIEventSource} from \"./UIEventSource\";\nimport {Playground} from \"../Layers/Playground\";\n\nexport abstract class UIElement {\n\n    private static nextId: number = 0;\n\n    public readonly id: string;\n    public readonly _source: UIEventSource<any>;\n    \n    private _hideIfEmpty = false;\n\n    protected constructor(source: UIEventSource<any>) {\n        this.id = \"ui-element-\" + UIElement.nextId;\n        this._source = source;\n        UIElement.nextId++;\n        this.ListenTo(source);\n    }\n\n\n    protected ListenTo(source: UIEventSource<any>) {\n        if (source === undefined) {\n            return;\n        }\n        const self = this;\n        source.addCallback(() => {\n            self.Update();\n        })\n    }\n\n    private _onClick: () => void;\n\n    public onClick(f: (() => void)) {\n        this._onClick = f;\n        this.Update();\n        return this;\n    }\n\n    Update(): void {\n        let element = document.getElementById(this.id);\n        if (element === null || element === undefined) {\n            // The element is not painted\n            return;\n        }\n\n        element.innerHTML = this.InnerRender();\n        if (this._hideIfEmpty) {\n            if (element.innerHTML === \"\") {\n                element.parentElement.style.display = \"none\";\n            } else {\n                element.parentElement.style.display = undefined;\n            }\n        }\n\n        if (this._onClick !== undefined) {\n            const self = this;\n            element.onclick = () => {\n                self._onClick();\n            }\n            element.style.pointerEvents = \"all\";\n            element.style.cursor = \"pointer\";\n        }\n\n        this.InnerUpdate(element);\n    }\n    \n    HideOnEmpty(hide : boolean){\n        this._hideIfEmpty = hide;\n        this.Update();\n        return this;\n    }\n    \n    // Called after the HTML has been replaced. Can be used for css tricks\n    InnerUpdate(htmlElement : HTMLElement){}\n\n    Render(): string {\n        return \"<span class='uielement' id='\" + this.id + \"'>\" + this.InnerRender() + \"</span>\"\n    }\n\n    AttachTo(divId: string) {\n        let element = document.getElementById(divId);\n        if(element === null){\n            console.log(\"SEVERE: could not attach UIElement to \", divId);\n            return;\n        }\n        element.innerHTML = this.Render();\n        this.Update();\n        return this;\n    }\n\n    protected abstract InnerRender(): string;\n    public Activate(): void {};\n\n    public IsEmpty(): boolean {\n        return this.InnerRender() === \"\";\n    }\n\n}","export class UIEventSource<T>{\n    \n    public data : T;\n    private _callbacks = [];\n\n    constructor(data: T) {\n        this.data = data;\n    }\n\n\n    public addCallback(callback: ((latestData : T) => void)) {\n        this._callbacks.push(callback);\n        return this;\n    }\n\n    public setData(t: T): void {\n        if (this.data === t) {\n            return;\n        }\n        this.data = t;\n        this.ping();\n    }\n\n    public ping(): void {\n        for (const callback of this._callbacks) {\n            callback(this.data);\n        }\n    }\n\n    public map<J>(f: ((T) => J)): UIEventSource<J> {\n        const self = this;\n        this.addCallback(function () {\n            newSource.setData(f(self.data));\n            newSource.ping();\n        });\n        const newSource = new UIEventSource<J>(\n            f(this.data)\n        );\n\n        return newSource;\n\n    }\n\n\n}","import {UIElement} from \"./UIElement\";\nimport {UIEventSource} from \"./UIEventSource\";\nimport {OsmConnection} from \"../Logic/OsmConnection\";\n\nexport class CenterMessageBox extends UIElement {\n\n    private readonly _location: UIEventSource<{ zoom: number }>;\n    private readonly _zoomInMore = new UIEventSource<boolean>(true);\n    private readonly _centermessage: UIEventSource<string>;\n    private readonly _osmConnection: OsmConnection;\n    private readonly _queryRunning: UIEventSource<boolean>;\n\n    constructor(\n        startZoom: number,\n        centermessage: UIEventSource<string>,\n        osmConnection: OsmConnection,\n        location: UIEventSource<{ zoom: number }>,\n        queryRunning: UIEventSource<boolean>\n    ) {\n        super(centermessage);\n\n        this._centermessage = centermessage;\n        this._location = location;\n        this._osmConnection = osmConnection;\n        this._queryRunning = queryRunning;\n        this.ListenTo(queryRunning);\n\n\n        const self = this;\n        location.addCallback(function () {\n            self._zoomInMore.setData(location.data.zoom < startZoom);\n        });\n        this.ListenTo(this._zoomInMore);\n\n    }\n\n    protected InnerRender(): string {\n\n        if (this._centermessage.data != \"\") {\n            return this._centermessage.data;\n        }\n\n        if (this._zoomInMore.data) {\n            return \"Zoom in om de data te zien en te bewerken\";\n        } else if (this._queryRunning.data) {\n            return \"Data wordt geladen...\";\n        }\n        return \"Klaar!\";\n    }\n\n\n    private ShouldShowSomething() : boolean{\n        if (this._queryRunning.data) {\n            return true;\n        }\n        return this._zoomInMore.data;\n    }\n\n    InnerUpdate(htmlElement: HTMLElement) {\n        const pstyle = htmlElement.parentElement.style;\n        if (this._centermessage.data != \"\") {\n            pstyle.opacity = \"1\";\n            pstyle.pointerEvents = \"all\";\n            this._osmConnection.registerActivateOsmAUthenticationClass();\n            return;\n        }\n        pstyle.pointerEvents = \"none\";\n\n\n        if (this.ShouldShowSomething()) {\n            pstyle.opacity = \"0.5\";\n        } else {\n            pstyle.opacity = \"0\";\n        }\n    }\n\n}\n\n\n"]}