{"version":3,"sources":["UI/UIElement.ts","UI/UIEventSource.ts","UI/CenterMessageBox.ts"],"names":[],"mappings":";;;;;;;AAGA,ACHA,IDGA,ACHA,SDGA,ICHA;ADGA,ACHA;ADGA,ACHA,YDGA,ACHA;ADYI,ACPA,WDOA,ACPA,SDOA,CAAsB,GCPtB,CAAY,EDOZ,EAAgD,ACPhD,EAAmB;ADKX,ACPA,SDOA,ACPA,UAAA,EDOA,CCPa,EDOE,ACPf,KDOA;AAGJ,ACPA,SDOK,ACPA,EDOL,ECPA,CDOU,ECPE,IAAZ,UDO0B,SAAS,CAAC,MAApC;AACA,ACPH,SDOQ,OAAL,GAAe,MAAf;AACA,IAAA,SAAS,CAAC,MAAV;AACA,ACNG,EAAA,ODME,MCNF,CAAA,CDMH,CAAc,MAAd,CCNG,CAAA,WAAA,GAAP,UAAmB,QAAnB,EAAuD;ADOtD,ACNG,SAAK,UAAL,CAAgB,IAAhB,CAAqB,QAArB;;ADSM,ACRN,EDQM,SAAA,ACRC,CDQD,GCRN,MDQM,CAAA,QAAA,GAAV,UAAmB,MAAnB,EAA6C;AACzC,ACRH,GAHM,KDWC,MAAM,KAAK,SAAf,EAA0B;AACtB;AACH,ACRE,EAAA,aAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAAmB;AACf,QAAI,KAAK,IAAL,KAAc,CAAlB,EAAqB;ADQrB,ACPI,QDOE,IAAI,GAAG,IAAb;AACA,ACPC,IDOD,MAAM,CAAC,WAAP,CAAmB,YAAA;AACf,MAAA,IAAI,CAAC,MAAL;AACH,ACRD,KDMA,ICNK,IAAL,GAAY,CAAZ;ADSH,ACRG,GDAM,MCAD,IAAL;AACH,GANM;ADiBA,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAA8B;AAC1B,ACVG,EAAA,ODUE,MCVF,CAAA,CDUH,GAAgB,CAAhB,ICVG,CAAA,IAAA,GAAP,YAAA;ADWI,ACVA,SDUK,ACVA,IAAI,CAAT,CDUA,GCVc,KAAK,UAAnB,EAA+B;ADWlC,ACVO,GDOD,QCPM,UAAL,CAAgB,CAAhB,EAAmB,KAAK,IAAxB;ACzBZ,AD0BS,IC1BT,WAAA,GAAA,OAAA,CAAA,aAAA,CAAA;AFqCI,ACVC,EDUD,CCdO,QDcP,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AEpCJ,AFqCQ,IErCR,IFqCY,OAAO,GAAG,CErCtB,GAAA,IFqC8B,CAAC,EErC/B,CAAA,WFqCsB,CAAwB,KErC9C,AFqCmD,CErCnD,CFqCsB,CAAd;ACTG,EAAA,aAAA,CAAA,SAAA,CAAA,GAAA,GAAP,UAAc,CAAd,EAA2B;ACzB/B,AFmCQ,ACTA,IC1BR,IFmCY,ACTE,IAAI,GDSC,ACTE,IAAb,CC1BR,AFmCwB,IAAZ,IAAoB,OAAO,KAAK,SAApC,EAA+C;AEnCvD,AFoCY,ACTJ,SAAK,WAAL,CAAiB,YAAA;AC3BzB,AFqCY,ACTA,MAAA,IC5BZ,KD4BqB,CC5BrB,AD4BsB,EC5BtB,KD4BY,CAAkB,CAAC,CAAC,IAAI,CAAC,IAAN,CAAnB;AC5B0B,AFsC7B,ACTG,EC7B0B,ID6B1B,KC7B0B,CAAA,GD6BjB,CAAC,IAAV,QC7B0B,EAAA,MAAA,CAAA;AD8B7B,KAHD;ACnBJ,AFgCI,ACTA,IDSA,ICTM,GCvBV,AFgCW,CAAC,KCTO,GAAG,CDSlB,GAAoB,ACTE,GCvB1B,CACI,CF+ByB,QEhC7B,ADuBsB,CACd,CCtBJ,ADsBK,CDQe,ACRd,EDQN,GCRW,IAAN,CADa,CAAlB,CCvBJ,EAGI,aAHJ,EAII,QAJJ,EAKI,YALJ,EAKwC;AALxC,AD2BI,QC3BJ,GD2BW,EC3BX,GAOI,IDoBA,ECpBA,CAAA,IAAA,CAAA,IAAA,EAAM,aAAN,KAAoB,IAPxB;AFiCI,ACJH,GAZM,KDgBC,KAAK,YAAT,EAAuB;AEtCV,AFuCT,IEvCS,KAAA,CAAA,AFuCL,OAAO,CAAC,GEvCH,GAAc,GFuCnB,CEvCuB,IFuCD,EAA1B,EAA8B,OEvCH,CAAA,aAAJ,CAA2B,IAA3B,CAAd;AAcb,AF0BQ,ACHhB,ICvBQ,IF0BQ,CE1BJ,ADuBZ,CCvBa,KF0BU,CAAC,MCHxB,ECvBQ,GAAsB,EF0Bd,CAAsB,KAAtB,CAA4B,IE1BpC,GF0BQ,GAAsC,MAAtC;AEzBR,AF0BK,AChDb,CAAA,EAAA,CCsBQ,GFwBI,EExBA,CAAC,GF0BM,ME1BX,GAAiB,QAAjB;AACA,AF0BQ,IE1BR,IF0BQ,CE1BJ,CAAC,KF0BU,CAAC,QE1BhB,GAAsB,EF0Bd,CAAsB,KAAtB,CAA4B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","file":"CenterMessageBox.js","sourceRoot":"..","sourcesContent":["import {UIEventSource} from \"./UIEventSource\";\nimport {Playground} from \"../Layers/Playground\";\n\nexport abstract class UIElement {\n\n    private static nextId: number = 0;\n\n    public readonly id: string;\n    public readonly _source: UIEventSource<any>;\n    \n    private _hideIfEmpty = false;\n\n    protected constructor(source: UIEventSource<any>) {\n        this.id = \"ui-element-\" + UIElement.nextId;\n        this._source = source;\n        UIElement.nextId++;\n        this.ListenTo(source);\n    }\n\n\n    protected ListenTo(source: UIEventSource<any>) {\n        if (source === undefined) {\n            return;\n        }\n        const self = this;\n        source.addCallback(() => {\n            self.Update();\n        })\n    }\n\n    private _onClick: () => void;\n\n    public onClick(f: (() => void)) {\n        this._onClick = f;\n        this.Update();\n    }\n\n    Update(): void {\n        let element = document.getElementById(this.id);\n        if (element === null || element === undefined) {\n            // The element is not painted\n            return;\n        }\n\n        element.innerHTML = this.InnerRender();\n        if (this._hideIfEmpty) {\n            if (element.innerHTML === \"\") {\n                element.parentElement.style.display = \"none\";\n            } else {\n                element.parentElement.style.display = undefined;\n            }\n        }\n\n        if (this._onClick !== undefined) {\n            console.log(\"Registering\")\n            const self = this;\n            element.onclick = () => {\n                console.log(\"Clicked!\")\n                self._onClick();\n            }\n            element.style.cursor = \"pointer\";\n        }\n\n        this.InnerUpdate(element);\n    }\n    \n    HideOnEmpty(hide : boolean){\n        this._hideIfEmpty = hide;\n        this.Update();\n        return this;\n    }\n    \n    // Called after the HTML has been replaced. Can be used for css tricks\n    InnerUpdate(htmlElement : HTMLElement){}\n\n    Render(): string {\n        return \"<span class='uielement' id='\" + this.id + \"'>\" + this.InnerRender() + \"</span>\"\n    }\n\n    AttachTo(divId: string) {\n        let element = document.getElementById(divId);\n        if(element === null){\n            console.log(\"SEVERE: could not attach UIElement to \", divId);\n            return;\n        }\n        element.innerHTML = this.Render();\n        this.Update();\n        return this;\n    }\n\n    protected abstract InnerRender(): string;\n    public Activate(): void {};\n\n    public IsEmpty(): boolean {\n        return this.InnerRender() === \"\";\n    }\n\n}","export class UIEventSource<T>{\n    \n    public data : T;\n    private _callbacks = [];\n\n    constructor(data: T) {\n        this.data = data;\n    }\n\n\n    public addCallback(callback: ((latestData : T) => void)) {\n        this._callbacks.push(callback);\n        return this;\n    }\n\n    public setData(t: T): void {\n        if (this.data === t) {\n            return;\n        }\n        this.data = t;\n        this.ping();\n    }\n\n    public ping(): void {\n        for (let i in this._callbacks) {\n            this._callbacks[i](this.data);\n        }\n    }\n\n    public map<J>(f: ((T) => J)): UIEventSource<J> {\n        const self = this;\n        this.addCallback(function () {\n            newSource.setData(f(self.data));\n            newSource.ping();\n        });\n        const newSource = new UIEventSource<J>(\n            f(this.data)\n        );\n\n        return newSource;\n\n    }\n\n\n}","import {UIElement} from \"./UIElement\";\nimport {UIEventSource} from \"./UIEventSource\";\nimport {OsmConnection} from \"../Logic/OsmConnection\";\n\nexport class CenterMessageBox extends UIElement {\n\n    private readonly _location: UIEventSource<{ zoom: number }>;\n    private readonly _zoomInMore = new UIEventSource<boolean>(true);\n    private readonly _centermessage: UIEventSource<string>;\n    private readonly _osmConnection: OsmConnection;\n    private readonly _queryRunning: UIEventSource<boolean>;\n\n    constructor(\n        startZoom: number,\n        centermessage: UIEventSource<string>,\n        osmConnection: OsmConnection,\n        location: UIEventSource<{ zoom: number }>,\n        queryRunning: UIEventSource<boolean>\n    ) {\n        super(centermessage);\n\n        this._centermessage = centermessage;\n        this._location = location;\n        this._osmConnection = osmConnection;\n        this._queryRunning = queryRunning;\n        this.ListenTo(queryRunning);\n\n\n        const self = this;\n        location.addCallback(function () {\n            self._zoomInMore.setData(location.data.zoom < startZoom);\n        });\n        this.ListenTo(this._zoomInMore);\n\n    }\n\n    protected InnerRender(): string {\n\n        if (this._centermessage.data != \"\") {\n            return this._centermessage.data;\n        }\n\n        if (this._zoomInMore.data) {\n            return \"Zoom in om de data te zien en te bewerken\";\n        } else if (this._queryRunning.data) {\n            return \"Data wordt geladen...\";\n        }\n        return \"Klaar!\";\n    }\n\n\n    private ShouldShowSomething() : boolean{\n        if (this._queryRunning.data) {\n            return true;\n        }\n        return this._zoomInMore.data;\n    }\n\n    InnerUpdate(htmlElement: HTMLElement) {\n        const pstyle = htmlElement.parentElement.style;\n        if (this._centermessage.data != \"\") {\n            pstyle.opacity = \"1\";\n            pstyle.pointerEvents = \"all\";\n            this._osmConnection.registerActivateOsmAUthenticationClass();\n            return;\n        }\n        pstyle.pointerEvents = \"none\";\n\n\n        if (this.ShouldShowSomething()) {\n            pstyle.opacity = \"0.5\";\n        } else {\n            pstyle.opacity = \"0\";\n        }\n    }\n\n}\n\n\n"]}