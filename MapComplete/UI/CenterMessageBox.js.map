{"version":3,"sources":["UI/UIElement.ts","UI/UIEventSource.ts","UI/CenterMessageBox.ts"],"names":[],"mappings":";;;;;;;AAEA,ACFA,IDEA,ACFA,SDEA,ICFA;ADEA,ACFA;ADEA,ACFA,YDEA,ACFA;ADWI,ACNA,WDMA,ACNA,SDMA,CAAsB,GCNtB,CAAY,EDMZ,EAAgD,ACNhD,EAAmB;ADIX,ACNA,SDMA,ACNA,UAAA,EDMA,CCNa,EDME,ACNf,KDMA;AAGJ,ACNA,SDMK,ACNA,EDML,ECNA,CDMU,ECNE,IAAZ,UDM0B,SAAS,CAAC,MAApC;AACA,ACNH,SDMQ,OAAL,GAAe,MAAf;AACA,IAAA,SAAS,CAAC,MAAV;AACA,ACLG,EAAA,ODKE,MCLF,CAAA,CDKH,CAAc,MAAd,CCLG,CAAA,WAAA,GAAP,UAAmB,QAAnB,EAAuD;ADMtD,ACLG,SAAK,UAAL,CAAgB,IAAhB,CAAqB,QAArB;;ADQG,ACPH,EDOG,SAAA,ACPI,CDOJ,GCPH,MDOG,CAAA,QAAA,GAAP,UAAgB,MAAhB,EAA0C;AACtC,ACPH,GAHM,KDUC,MAAM,KAAK,SAAf,EAA0B;AACtB;AACH,ACPE,EAAA,aAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAAmB;AACf,QAAI,KAAK,IAAL,KAAc,CAAlB,EAAqB;ADOrB,ACNI,QDME,IAAI,GAAG,IAAb;AACA,ACNC,IDMD,MAAM,CAAC,WAAP,CAAmB,YAAA;AACf,MAAA,IAAI,CAAC,MAAL;AACH,ACPD,KDKA,ICLK,IAAL,GAAY,CAAZ;ADQH,ACPG,GDDG,MCCE,IAAL;AACH,GANM;ADgBA,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAA8B;AAC1B,ACTG,EAAA,ODSE,MCTF,CAAA,CDSH,GAAgB,CAAhB,ICTG,CAAA,IAAA,GAAP,YAAA;ADUI,ACTA,SDSK,ACTkB,IAAA,EDSvB,ACTuB,GAAA,CAAA,EAAA,EAAA,GAAA,KAAK,UAA5B,EAAuB,EAAA,GAAA,EAAA,CAAA,MAAvB,EAAuB,EAAA,EAAvB,EAAwC;ADUxC,ACVK,UAAM,CDUJ,IAAP,GCVmB,GAAA,EAAA,CAAA,EAAA,CAAd;ACxBb,AFmCK,ACVO,GDMD,CE/BX,EDyBY,QAAQ,CCzBpB,ADyBqB,GCzBrB,EDyB0B,IAAN,CCzBpB,ADyBY,CCzBZ,aAAA,CAAA;AD0BS;ACzBT,AFoCI,ACVC,EDUD,CCdO,CCtBX,OFoCI,CAAA,OEpCJ,EFoCI,CEpCJ,AFoCI,MAAA,CEpCJ,CAAA,CFoCI,YAAA,IEpCJ,CAAA;AFqCQ,QAAI,OAAO,GAAG,QAAQ,CAAC,cAAT,CAAwB,KAAK,EAA7B,CAAd;AElCR,ADyBW,EAAA,ECzBX,WDyBW,CAAA,ICzBX,KDyBW,CAAA,GAAA,GAAP,UAAc,CAAd,EACc,YADd,EACsD;AC1B1D,AFmCQ,ACTU,QDSN,ACTM,ODSC,KAAK,ACTN,IDSN,CCTM,GDSc,ECTd,CAAA,EAAA,EDSqB,KAAK,SAApC,EAA+C;AEnCvD,AFoCY,ACVM,MAAA,IC1BlB,MAAA,EAAA,AD0BkB,GAAA,EAAA;AC1BoB,AFqC1B,ACX8C,EC1BpB,SAAA,CAAA,gBAAA,EAAA,MAAA,CAAA;AFsC7B;AE9BL,ADmBI,QAAM,GCnBV,CDmBc,GAAG,IAAb,QCnBJ,CACI,SADJ,EAEI,aAFJ,EAGI,aAHJ,EAII,QAJJ,EAKI,YALJ,EAKwC;AALxC,AFgCI,IAAA,IEhCJ,GFgCW,CAAC,CEhCZ,GAOI,KFyBA,CEzBA,CAAA,CFyBoB,GEzBpB,CAAA,CFyByB,GEzBzB,EAAM,MFyBc,EAApB,KEzBA,KAAoB,IAPxB;ADqBI,QAAM,MAAM,GAAG,SAAT,MAAS,GAAA;AC1BF,AFsCb,ACXI,IC3BS,ED2BT,EDWA,CEtCS,CAAA,GFsCJ,ECXI,CAAC,KC3BD,ED2BT,CC3BuB,AD2BL,CDWtB,ACXuB,CAAC,CDWD,CEtCQ,ED2BH,CAAC,IAAN,CAAnB,OC3B2B,CAAA,aAAJ,CAA2B,IAA3B,CAAd;AAcb,AFyBI,ACXA,ICdJ,EDcI,GCdA,CAAC,AFyBG,KCXK,CAAC,CDWC,CAAC,ECXZ,ICdJ,GAAsB,AFyBd,KAAsB,EAA1B,EAA8B,IEzBlC;AACA,AFyBQ,ACXP,ICdD,CDWA,GDcQ,CEzBJ,CAAC,KFyBU,CAAC,GEzBhB,GAAiB,OFyBT,CEzBR,AFyB8B,KAAtB,CAA4B,OAA5B,GAAsC,MAAtC;AExBR,AFyBK,IEzBL,GFuBI,EEvB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","file":"CenterMessageBox.js","sourceRoot":"..","sourcesContent":["import {UIEventSource} from \"./UIEventSource\";\n\nexport abstract class UIElement {\n\n    private static nextId: number = 0;\n\n    public readonly id: string;\n    public readonly _source: UIEventSource<any>;\n    \n    private _hideIfEmpty = false;\n\n    protected constructor(source: UIEventSource<any>) {\n        this.id = \"ui-element-\" + UIElement.nextId;\n        this._source = source;\n        UIElement.nextId++;\n        this.ListenTo(source);\n    }\n\n\n    public ListenTo(source: UIEventSource<any>) {\n        if (source === undefined) {\n            return;\n        }\n        const self = this;\n        source.addCallback(() => {\n            self.Update();\n        })\n    }\n\n    private _onClick: () => void;\n\n    public onClick(f: (() => void)) {\n        this._onClick = f;\n        this.Update();\n        return this;\n    }\n\n    Update(): void {\n        let element = document.getElementById(this.id);\n        if (element === null || element === undefined) {\n            // The element is not painted\n            return;\n        }\n\n        element.innerHTML = this.InnerRender();\n        if (this._hideIfEmpty) {\n            if (element.innerHTML === \"\") {\n                element.parentElement.style.display = \"none\";\n            } else {\n                element.parentElement.style.display = undefined;\n            }\n        }\n\n        if (this._onClick !== undefined) {\n            const self = this;\n            element.onclick = () => {\n                self._onClick();\n            }\n            element.style.pointerEvents = \"all\";\n            element.style.cursor = \"pointer\";\n           /*\n            const childs = element.children;\n            for (let i = 0; i < childs.length; i++) {\n                const ch = childs[i];\n                console.log(ch);\n                ch.style.cursor = \"pointer\";\n                ch.onclick = () => {\n                    self._onClick();\n                }\n                ch.style.pointerEvents = \"all\";\n            }*/\n        }\n\n        this.InnerUpdate(element);\n    }\n    \n    HideOnEmpty(hide : boolean){\n        this._hideIfEmpty = hide;\n        this.Update();\n        return this;\n    }\n    \n    // Called after the HTML has been replaced. Can be used for css tricks\n    InnerUpdate(htmlElement : HTMLElement){}\n\n    Render(): string {\n        return \"<span class='uielement' id='\" + this.id + \"'>\" + this.InnerRender() + \"</span>\"\n    }\n\n    AttachTo(divId: string) {\n        let element = document.getElementById(divId);\n        if(element === null){\n            console.log(\"SEVERE: could not attach UIElement to \", divId);\n            return;\n        }\n        element.innerHTML = this.Render();\n        this.Update();\n        return this;\n    }\n\n    protected abstract InnerRender(): string;\n    public Activate(): void {};\n\n    public IsEmpty(): boolean {\n        return this.InnerRender() === \"\";\n    }\n\n}","export class UIEventSource<T>{\n    \n    public data : T;\n    private _callbacks = [];\n\n    constructor(data: T) {\n        this.data = data;\n    }\n\n\n    public addCallback(callback: ((latestData : T) => void)) {\n        this._callbacks.push(callback);\n        return this;\n    }\n\n    public setData(t: T): void {\n        if (this.data === t) {\n            return;\n        }\n        this.data = t;\n        this.ping();\n    }\n\n    public ping(): void {\n        for (const callback of this._callbacks) {\n            callback(this.data);\n        }\n    }\n\n    public map<J>(f: ((T) => J),\n                  extraSources : UIEventSource<any>[] = []): UIEventSource<J> {\n        const self = this;\n        \n        const update = function () {\n            newSource.setData(f(self.data));\n            newSource.ping();\n        }\n        \n        this.addCallback(update);\n        for (const extraSource of extraSources) {\n            extraSource.addCallback(update);\n        }\n        const newSource = new UIEventSource<J>(\n            f(this.data)\n        );\n        \n\n        return newSource;\n\n    }\n\n\n}","import {UIElement} from \"./UIElement\";\nimport {UIEventSource} from \"./UIEventSource\";\nimport {OsmConnection} from \"../Logic/OsmConnection\";\n\nexport class CenterMessageBox extends UIElement {\n\n    private readonly _location: UIEventSource<{ zoom: number }>;\n    private readonly _zoomInMore = new UIEventSource<boolean>(true);\n    private readonly _centermessage: UIEventSource<string>;\n    private readonly _osmConnection: OsmConnection;\n    private readonly _queryRunning: UIEventSource<boolean>;\n\n    constructor(\n        startZoom: number,\n        centermessage: UIEventSource<string>,\n        osmConnection: OsmConnection,\n        location: UIEventSource<{ zoom: number }>,\n        queryRunning: UIEventSource<boolean>\n    ) {\n        super(centermessage);\n\n        this._centermessage = centermessage;\n        this._location = location;\n        this._osmConnection = osmConnection;\n        this._queryRunning = queryRunning;\n        this.ListenTo(queryRunning);\n\n\n        const self = this;\n        location.addCallback(function () {\n            self._zoomInMore.setData(location.data.zoom < startZoom);\n        });\n        this.ListenTo(this._zoomInMore);\n\n    }\n\n    protected InnerRender(): string {\n\n        if (this._centermessage.data != \"\") {\n            return this._centermessage.data;\n        }\n\n        if (this._zoomInMore.data) {\n            return \"Zoom in om de data te zien en te bewerken\";\n        } else if (this._queryRunning.data) {\n            return \"Data wordt geladen...\";\n        }\n        return \"Klaar!\";\n    }\n\n\n    private ShouldShowSomething() : boolean{\n        if (this._queryRunning.data) {\n            return true;\n        }\n        return this._zoomInMore.data;\n    }\n\n    InnerUpdate(htmlElement: HTMLElement) {\n        const pstyle = htmlElement.parentElement.style;\n        if (this._centermessage.data != \"\") {\n            pstyle.opacity = \"1\";\n            pstyle.pointerEvents = \"all\";\n            this._osmConnection.registerActivateOsmAUthenticationClass();\n            return;\n        }\n        pstyle.pointerEvents = \"none\";\n\n\n        if (this.ShouldShowSomething()) {\n            pstyle.opacity = \"0.5\";\n        } else {\n            pstyle.opacity = \"0\";\n        }\n    }\n\n}\n\n\n"]}