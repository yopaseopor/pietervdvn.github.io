{"version":3,"sources":["UI/UIElement.ts","UI/Base/FixedUiElement.ts","UI/Base/Button.ts","UI/SimpleAddUI.ts"],"names":[],"mappings":";;;;;;;AAEA,IAAA,SAAA;AAAA;AAAA,YAAA;AASI,WAAA,SAAA,CAAsB,MAAtB,EAAgD;AAFxC,SAAA,YAAA,GAAe,KAAf;AAGJ,SAAK,EAAL,GAAU,gBAAgB,SAAS,CAAC,MAApC;AACA,SAAK,OAAL,GAAe,MAAf;AACA,IAAA,SAAS,CAAC,MAAV;AACA,SAAK,QAAL,CAAc,MAAd;AACH;;AAGM,EAAA,SAAA,CAAA,SAAA,CAAA,QAAA,GAAP,UAAgB,MAAhB,EAA0C;AACtC,QAAI,MAAM,KAAK,SAAf,EAA0B;AACtB;AACH;;AACD,QAAM,IAAI,GAAG,IAAb;AACA,IAAA,MAAM,CAAC,WAAP,CAAmB,YAAA;AACf,MAAA,IAAI,CAAC,MAAL;AACH,KAFD;AAGH,GARM;;AAYA,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAA8B;AAC1B,SAAK,QAAL,GAAgB,CAAhB;AACA,SAAK,MAAL;AACA,WAAO,IAAP;AElCR,ADAA,AEAA,AHmCK,GAJM,CE/BX,ADAA,AEAA,WDAA,ADAA,AEAA,GDAA,ADAA,AEAA,ODAA,ADAA,AEAA,CDAA,ADAA,AEAA,aAAA,CDAA,ADAA,AEAA,CDAA,ADAA;;ACEA,ADAA,AEGA,AHgCI,EAAA,EEnCJ,ADAA,AEGA,MDHA,CFmCI,CAAA,MCnCJ,EEGA,CHgCI,CAAA,CGhCJ,KHgCI,EGhCJ,CAAA,AHgCI,YAAA,WGhCJ,CAAA;ADHA,ADAA,ADoCQ,QAAI,OAAO,GAAG,QAAQ,CAAC,cAAT,CAAwB,KAAK,EAA7B,CAAd;AEpCR,ADAA,AEIA,IAAA,MDJA,ADAA,EEIA,GAAA,CDJA,ADAA,ECAA,ADAA,IEIA,CAAA,eAAA,CAAA;ADJ4B,ADAQ,AEOpC,AH8BQ,EErCoB,ADAQ,MDqCxB,GErCgB,ADAQ,CCAR,ADAQ,GDqCjB,GErCS,EAAA,AFqCJ,IAAZ,EErCgB,ADAQ,CCAR,CDAQ,ADqCJ,MCrCI,CAAA,ADqCG,KAAK,SAApC,EAA+C;AAC3C;AEjCR,ADFA,ADoCQ,WElCR,ADFA,MCEA,CAAY,IAAZ,EAA6B,CDF7B,CAAY,IAAZ,CCEA,CDFwB,CCE4B,IAApD,EAAqE;AAAjB,ADFpD,ADqCK,QEnC+C,ADFpD,ICEoD,CDFpD,GACI,CCCgD,KAAA,ADDhD,CCCgD,ADDhD,ECCgD,EDDhD,CAAA,IAAA,EAAM,SAAN,KAAgB,IADpB;ACEoD,MAAA,IAAA,GAAA,EAAA;AAAiB,ADAjE,AEKR,AHgCQ,ICrCA,AEKR,AHgCQ,KCrCI,CAAC,CDqCE,CAAC,GCrCR,AEKR,GFLqB,GDqCb,CCrCA,EDqCoB,KAAK,WAAL,EAApB;AGhCR;ADLI,ADCC,AEIL,AHiCQ,QEtCJ,AFsCQ,EGjCZ,GDLI,AFsCa,GErCT,ACIR,EAAA,IDJQ,CAAA,EFqCA,EErCA,AFqCuB,CErCvB,IAAA,EAAM,SAAN,KAAgB,IADpB;ACK6B,AHkCrB,EGlCqB,QHkCjB,CGlCiB,CAAA,KHkCV,CAAC,KGlCS,EAAA,EHkCjB,IGlCiB,CAAA,AHkCK,EAA1B,EAA8B;AErClC,ADCM,ADqCE,ECrCF,ECDN,IFsCQ,CEtCJ,CAAC,KAAL,AFsCe,CCrCT,ADqCU,CCrCV,CCDO,IAAb,IDCM,CAAA,EDqCE,CAAsB,KAAtB,CAA4B,ECrC9B,GAAV,EDqCY,GAAsC,MAAtC,CCrCZ;ACAI,ADCA,AEUJ,AH2BS,IEtCL,GFoCI,EEpCA,CAAC,CDCE,AEUX,EH2Be,GCrCC,ECDZ,GAAgB,ADChB,CEUJ,CAAY,KDXR,ICWJ,EACY,iBADZ,EAEY,OAFZ,EAGY,eAHZ,EAIY,aAJZ,EAKY,WALZ,EAMY,UANZ,EAMkG;AFfjG,AESD,AH4BY,GCvCF,KEWV,AH4BY,KG5BZ,EH4BmB,CGpBf,AHoBgB,MGpBhB,CAAA,IAAA,CAAA,CHoBQ,CAAsB,EGpB9B,EAAM,CHoBE,CAA4B,OGpBpC,AHoBQ,GAAsC,EGpB9B,IARpB,GH4BY;AEtCR,AFuCK,QEvCD,IAAI,KAAK,EAAb,EAAiB;AAEb,ADEZ,AEeQ,AHqBC,IGrBD,EDjBI,GDEZ,AEeY,CAAC,CDjBG,CAAC,KAAL,GAAa,ACiBjB,GFfR,AEe0B,SDjBW,ACiB7B,IDjBiB,GAAmB,GAAhC;AACH,ADZT,AE6BQ,CF7BR,CAAoC,EE6B5B,CDpBA,ICoBI,CAAC,CDjBA,EDZ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","file":"SimpleAddUI.js","sourceRoot":"..","sourcesContent":["import {UIEventSource} from \"./UIEventSource\";\n\nexport abstract class UIElement {\n\n    private static nextId: number = 0;\n\n    public readonly id: string;\n    public readonly _source: UIEventSource<any>;\n    \n    private _hideIfEmpty = false;\n\n    protected constructor(source: UIEventSource<any>) {\n        this.id = \"ui-element-\" + UIElement.nextId;\n        this._source = source;\n        UIElement.nextId++;\n        this.ListenTo(source);\n    }\n\n\n    public ListenTo(source: UIEventSource<any>) {\n        if (source === undefined) {\n            return;\n        }\n        const self = this;\n        source.addCallback(() => {\n            self.Update();\n        })\n    }\n\n    private _onClick: () => void;\n\n    public onClick(f: (() => void)) {\n        this._onClick = f;\n        this.Update();\n        return this;\n    }\n\n    Update(): void {\n        let element = document.getElementById(this.id);\n        if (element === null || element === undefined) {\n            // The element is not painted\n            return;\n        }\n\n        element.innerHTML = this.InnerRender();\n        if (this._hideIfEmpty) {\n            if (element.innerHTML === \"\") {\n                element.parentElement.style.display = \"none\";\n            } else {\n                element.parentElement.style.display = undefined;\n            }\n        }\n\n        if (this._onClick !== undefined) {\n            const self = this;\n            element.onclick = () => {\n                self._onClick();\n            }\n            element.style.pointerEvents = \"all\";\n            element.style.cursor = \"pointer\";\n           /*\n            const childs = element.children;\n            for (let i = 0; i < childs.length; i++) {\n                const ch = childs[i];\n                console.log(ch);\n                ch.style.cursor = \"pointer\";\n                ch.onclick = () => {\n                    self._onClick();\n                }\n                ch.style.pointerEvents = \"all\";\n            }*/\n        }\n\n        this.InnerUpdate(element);\n    }\n    \n    HideOnEmpty(hide : boolean){\n        this._hideIfEmpty = hide;\n        this.Update();\n        return this;\n    }\n    \n    // Called after the HTML has been replaced. Can be used for css tricks\n    InnerUpdate(htmlElement : HTMLElement){}\n\n    Render(): string {\n        return \"<span class='uielement' id='\" + this.id + \"'>\" + this.InnerRender() + \"</span>\"\n    }\n\n    AttachTo(divId: string) {\n        let element = document.getElementById(divId);\n        if(element === null){\n            console.log(\"SEVERE: could not attach UIElement to \", divId);\n            return;\n        }\n        element.innerHTML = this.Render();\n        this.Update();\n        return this;\n    }\n\n    protected abstract InnerRender(): string;\n    public Activate(): void {};\n\n    public IsEmpty(): boolean {\n        return this.InnerRender() === \"\";\n    }\n\n}","import {UIElement} from \"../UIElement\";\n\nexport class FixedUiElement extends UIElement {\n    private _html: string;\n\n    constructor(html: string) {\n        super(undefined);\n        this._html = html;\n    }\n\n    protected InnerRender(): string {\n        return this._html;\n    }\n\n\n}","import {UIElement} from \"../UIElement\";\n\nexport class Button extends UIElement {\n    private _text: UIElement;\n    private _onclick: () => void;\n    private _clss: string;\n\n    constructor(text: UIElement, onclick: (() => void), clss: string = \"\") {\n        super(undefined);\n        this._text = text;\n        this._onclick = onclick;\n        if (clss !== \"\") {\n\n            this._clss = \"class='\" + clss + \"'\";\n        }else{\n            this._clss = \"\";\n        }\n    }\n\n\n    protected InnerRender(): string {\n\n        return \"<form>\" +\n            \"<button id='button-\"+this.id+\"' type='button' \"+this._clss+\">\" + this._text.Render() +  \"</button>\" +\n            \"</form>\";\n    }\n\n    InnerUpdate(htmlElement: HTMLElement) {\n        super.InnerUpdate(htmlElement);\n        const self = this;\n        console.log(\"Update for \", htmlElement)\n        document.getElementById(\"button-\"+this.id).onclick = function(){\n            console.log(\"Clicked\");\n            self._onclick();\n        }\n    }\n\n}","import {UIElement} from \"./UIElement\";\nimport {UIEventSource} from \"./UIEventSource\";\nimport {Tag} from \"../Logic/TagsFilter\";\nimport {FilteredLayer} from \"../Logic/FilteredLayer\";\nimport {Changes} from \"../Logic/Changes\";\nimport {FixedUiElement} from \"./Base/FixedUiElement\";\nimport {Button} from \"./Base/Button\";\nimport {UserDetails} from \"../Logic/OsmConnection\";\n\n/**\n * Asks to add a feature at the last clicked location, at least if zoom is sufficient\n */\nexport class SimpleAddUI extends UIElement {\n    private _zoomlevel: UIEventSource<{ zoom: number }>;\n    private _addButtons: UIElement[];\n    private _lastClickLocation: UIEventSource<{ lat: number; lon: number }>;\n    private _changes: Changes;\n    private _selectedElement: UIEventSource<any>;\n    private _dataIsLoading: UIEventSource<boolean>;\n    private _userDetails: UIEventSource<UserDetails>;\n\n    constructor(zoomlevel: UIEventSource<{ zoom: number }>,\n                lastClickLocation: UIEventSource<{ lat: number, lon: number }>,\n                changes: Changes,\n                selectedElement: UIEventSource<any>,\n                dataIsLoading: UIEventSource<boolean>,\n                userDetails: UIEventSource<UserDetails>,\n                addButtons: { name: string; icon: string; tags: Tag[]; layerToAddTo: FilteredLayer }[],\n    ) {\n        super(zoomlevel);\n        this._zoomlevel = zoomlevel;\n        this._lastClickLocation = lastClickLocation;\n        this._changes = changes;\n        this._selectedElement = selectedElement;\n        this._dataIsLoading = dataIsLoading;\n        this._userDetails = userDetails;\n        this.ListenTo(userDetails);\n        this.ListenTo(dataIsLoading);\n        this._addButtons = [];\n\n        for (const option of addButtons) {\n            // <button type='button'> looks SO retarded\n            // the default type of button is 'submit', which performs a POST and page reload\n            const button =\n                new Button(new FixedUiElement(\"Voeg hier een \" + option.name + \" toe\"),\n                    this.CreatePoint(option));\n            this._addButtons.push(button);\n        }\n    }\n\n    private CreatePoint(option: { name: string; icon: string; tags: Tag[]; layerToAddTo: FilteredLayer }) {\n        const self = this;\n        return () => {\n\n            console.log(\"Creating a new \", option.name, \" at last click location\");\n            const loc = self._lastClickLocation.data;\n            let feature = self._changes.createElement(option.tags, loc.lat, loc.lon);\n            option.layerToAddTo.AddNewElement(feature);\n            self._selectedElement.setData(feature.properties);\n        }\n    }\n\n    protected InnerRender(): string {\n        const header = \"<h2>Geen selectie</h2>\" +\n            \"Je klikte ergens waar er nog geen gezochte data is.<br/>\";\n        if (!this._userDetails.data.loggedIn) {\n            return header + \"<a class='activate-osm-authentication'>Gelieve je aan te melden om een nieuw punt toe te voegen</a>\"\n        }\n\n        if (this._zoomlevel.data.zoom < 19) {\n            return header + \"Zoom verder in om een element toe te voegen.\";\n        }\n\n        if (this._dataIsLoading.data) {\n            return header + \"De data is nog aan het laden. Nog even geduld, dan kan je een punt toevoegen\";\n        }\n\n        var html = \"\";\n        for (const button of this._addButtons) {\n            html += button.Render();\n        }\n        return header + html;\n    }\n\n    InnerUpdate(htmlElement: HTMLElement) {\n        super.InnerUpdate(htmlElement);\n        for (const button of this._addButtons) {\n            button.Update();\n        }\n        this._userDetails.data.osmConnection.registerActivateOsmAUthenticationClass();\n    }\n\n}"]}