{"version":3,"sources":["UI/UIElement.ts","UI/Base/FixedUiElement.ts","UI/Base/Button.ts","UI/SimpleAddUI.ts"],"names":[],"mappings":";;;;;;;AAGA,IAAA,SAAA;AAAA;AAAA,YAAA;AASI,WAAA,SAAA,CAAsB,MAAtB,EAAgD;AAFxC,SAAA,YAAA,GAAe,KAAf;AAGJ,SAAK,EAAL,GAAU,gBAAgB,SAAS,CAAC,MAApC;AACA,SAAK,OAAL,GAAe,MAAf;AACA,IAAA,SAAS,CAAC,MAAV;AACA,SAAK,QAAL,CAAc,MAAd;AACH;;AAGS,EAAA,SAAA,CAAA,SAAA,CAAA,QAAA,GAAV,UAAmB,MAAnB,EAA6C;AACzC,QAAI,MAAM,KAAK,SAAf,EAA0B;AACtB;AACH;;AACD,QAAM,IAAI,GAAG,IAAb;AACA,IAAA,MAAM,CAAC,WAAP,CAAmB,YAAA;AACf,MAAA,IAAI,CAAC,MAAL;AACH,KAFD;AAGH,GARS;;AAYH,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAA8B;AAC1B,SAAK,QAAL,GAAgB,CAAhB;AACA,SAAK,MAAL;AACA,WAAO,IAAP;AEnCR,ADAA,AEAA,AHoCK,GAJM,CEhCX,ADAA,AEAA,WDAA,ADAA,AEAA,GDAA,ADAA,AEAA,ODAA,ADAA,AEAA,CDAA,ADAA,AEAA,aAAA,CDAA,ADAA,AEAA,CDAA,ADAA;;ACEA,ADAA,AEGA,AHiCI,EAAA,EEpCJ,ADAA,AEGA,MDHA,CFoCI,CAAA,MCpCJ,EEGA,CHiCI,CAAA,CGjCJ,KHiCI,EGjCJ,CAAA,AHiCI,YAAA,WGjCJ,CAAA;ADHA,ADAA,ADqCQ,QAAI,OAAO,GAAG,QAAQ,CAAC,cAAT,CAAwB,KAAK,EAA7B,CAAd;AErCR,ADAA,AEIA,IAAA,MDJA,ADAA,EEIA,GAAA,CDJA,ADAA,ECAA,ADAA,IEIA,CAAA,eAAA,CAAA;ADJ4B,ADAQ,AEOpC,AH+BQ,EEtCoB,ADAQ,MDsCxB,GEtCgB,ADAQ,CCAR,ADAQ,GDsCjB,GEtCS,EAAA,AFsCJ,IAAZ,EEtCgB,ADAQ,CCAR,CDAQ,ADsCJ,MCtCI,CAAA,ADsCG,KAAK,SAApC,EAA+C;AAC3C;AElCR,ADFA,ADqCQ,WEnCR,ADFA,MCEA,CAAY,IAAZ,EAA6B,CDF7B,CAAY,IAAZ,CCEA,CDFwB,CCE4B,IAApD,EAAqE;AAAjB,ADFpD,ADsCK,QEpC+C,ADFpD,ICEoD,CDFpD,GACI,CCCgD,KAAA,ADDhD,CCCgD,ADDhD,ECCgD,EDDhD,CAAA,IAAA,EAAM,SAAN,KAAgB,IADpB;ACEoD,MAAA,IAAA,GAAA,EAAA;AAAiB,ADAjE,AEKR,AHiCQ,ICtCA,AEKR,AHiCQ,KCtCI,CAAC,CDsCE,CAAC,GCtCR,AEKR,GFLqB,GDsCb,CCtCA,EDsCoB,KAAK,WAAL,EAApB;AGjCR;ADLI,ADCC,AEIL,AHkCQ,QEvCJ,AFuCQ,EGlCZ,GDLI,AFuCa,GEtCT,ACIR,EAAA,IDJQ,CAAA,EFsCA,EEtCA,AFsCuB,CEtCvB,IAAA,EAAM,SAAN,KAAgB,IADpB;ACK6B,AHmCrB,EGnCqB,QHmCjB,CGnCiB,CAAA,KHmCV,CAAC,KGnCS,EAAA,EHmCjB,IGnCiB,CAAA,AHmCK,EAA1B,EAA8B;AEtClC,ADCM,ADsCE,ECtCF,ECDN,IFuCQ,CEvCJ,CAAC,KAAL,AFuCe,CCtCT,ADsCU,CCtCV,CCDO,IAAb,IDCM,CAAA,EDsCE,CAAsB,KAAtB,CAA4B,ECtC9B,GAAV,EDsCY,GAAsC,MAAtC,CCtCZ;ACAI,ADCA,AEUJ,AH4BS,IEvCL,GFqCI,EErCA,CAAC,CDCE,AEUX,EH4Be,GCtCC,ECDZ,GAAgB,ADChB,CEUJ,CAAY,KDXR,ICWJ,EACY,iBADZ,EAEY,OAFZ,EAGY,eAHZ,EAIY,aAJZ,EAKY,WALZ,EAMY,UANZ,EAMkG;AFfjG,AESD,AH6BY,GCxCF,KEWV,AH6BY,KG7BZ,EH6BmB,CGrBf,AHqBgB,MGrBhB,CAAA,IAAA,CAAA,CHqBQ,CAAsB,EGrB9B,EAAM,CHqBE,CAA4B,OGrBpC,AHqBQ,GAAsC,EGrB9B,IARpB,GH6BY;AEvCR,AFwCK,QExCD,IAAI,KAAK,EAAb,EAAiB;AAEb,ADEZ,AEeQ,AHsBC,IGtBD,EDjBI,GDEZ,AEeY,CAAC,CDjBG,CAAC,KAAL,GAAa,ACiBjB,GFfR,AEe0B,SDjBW,ACiB7B,IDjBiB,GAAmB,GAAhC;AACH,ADZT,AE6BQ,CF7BR,CAAoC,EE6B5B,CDpBA,ICoBI,CAAC,CDjBA,EDZ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","file":"SimpleAddUI.js","sourceRoot":"..","sourcesContent":["import {UIEventSource} from \"./UIEventSource\";\nimport {Playground} from \"../Layers/Playground\";\n\nexport abstract class UIElement {\n\n    private static nextId: number = 0;\n\n    public readonly id: string;\n    public readonly _source: UIEventSource<any>;\n    \n    private _hideIfEmpty = false;\n\n    protected constructor(source: UIEventSource<any>) {\n        this.id = \"ui-element-\" + UIElement.nextId;\n        this._source = source;\n        UIElement.nextId++;\n        this.ListenTo(source);\n    }\n\n\n    protected ListenTo(source: UIEventSource<any>) {\n        if (source === undefined) {\n            return;\n        }\n        const self = this;\n        source.addCallback(() => {\n            self.Update();\n        })\n    }\n\n    private _onClick: () => void;\n\n    public onClick(f: (() => void)) {\n        this._onClick = f;\n        this.Update();\n        return this;\n    }\n\n    Update(): void {\n        let element = document.getElementById(this.id);\n        if (element === null || element === undefined) {\n            // The element is not painted\n            return;\n        }\n\n        element.innerHTML = this.InnerRender();\n        if (this._hideIfEmpty) {\n            if (element.innerHTML === \"\") {\n                element.parentElement.style.display = \"none\";\n            } else {\n                element.parentElement.style.display = undefined;\n            }\n        }\n\n        if (this._onClick !== undefined) {\n            const self = this;\n            element.onclick = () => {\n                self._onClick();\n            }\n            element.style.pointerEvents = \"all\";\n            element.style.cursor = \"pointer\";\n        }\n\n        this.InnerUpdate(element);\n    }\n    \n    HideOnEmpty(hide : boolean){\n        this._hideIfEmpty = hide;\n        this.Update();\n        return this;\n    }\n    \n    // Called after the HTML has been replaced. Can be used for css tricks\n    InnerUpdate(htmlElement : HTMLElement){}\n\n    Render(): string {\n        return \"<span class='uielement' id='\" + this.id + \"'>\" + this.InnerRender() + \"</span>\"\n    }\n\n    AttachTo(divId: string) {\n        let element = document.getElementById(divId);\n        if(element === null){\n            console.log(\"SEVERE: could not attach UIElement to \", divId);\n            return;\n        }\n        element.innerHTML = this.Render();\n        this.Update();\n        return this;\n    }\n\n    protected abstract InnerRender(): string;\n    public Activate(): void {};\n\n    public IsEmpty(): boolean {\n        return this.InnerRender() === \"\";\n    }\n\n}","import {UIElement} from \"../UIElement\";\n\nexport class FixedUiElement extends UIElement {\n    private _html: string;\n\n    constructor(html: string) {\n        super(undefined);\n        this._html = html;\n    }\n\n    protected InnerRender(): string {\n        return this._html;\n    }\n\n\n}","import {UIElement} from \"../UIElement\";\n\nexport class Button extends UIElement {\n    private _text: UIElement;\n    private _onclick: () => void;\n    private _clss: string;\n\n    constructor(text: UIElement, onclick: (() => void), clss: string = \"\") {\n        super(undefined);\n        this._text = text;\n        this._onclick = onclick;\n        if (clss !== \"\") {\n\n            this._clss = \"class='\" + clss + \"'\";\n        }else{\n            this._clss = \"\";\n        }\n    }\n\n\n    protected InnerRender(): string {\n\n        return \"<form>\" +\n            \"<button id='button-\"+this.id+\"' type='button' \"+this._clss+\">\" + this._text.Render() +  \"</button>\" +\n            \"</form>\";\n    }\n\n    InnerUpdate(htmlElement: HTMLElement) {\n        super.InnerUpdate(htmlElement);\n        const self = this;\n        console.log(\"Update for \", htmlElement)\n        document.getElementById(\"button-\"+this.id).onclick = function(){\n            console.log(\"Clicked\");\n            self._onclick();\n        }\n    }\n\n}","import {UIElement} from \"./UIElement\";\nimport {UIEventSource} from \"./UIEventSource\";\nimport {Tag} from \"../Logic/TagsFilter\";\nimport {FilteredLayer} from \"../Logic/FilteredLayer\";\nimport {Changes} from \"../Logic/Changes\";\nimport {FixedUiElement} from \"./Base/FixedUiElement\";\nimport {Button} from \"./Base/Button\";\nimport {UserDetails} from \"../Logic/OsmConnection\";\n\n/**\n * Asks to add a feature at the last clicked location, at least if zoom is sufficient\n */\nexport class SimpleAddUI extends UIElement {\n    private _zoomlevel: UIEventSource<{ zoom: number }>;\n    private _addButtons: UIElement[];\n    private _lastClickLocation: UIEventSource<{ lat: number; lon: number }>;\n    private _changes: Changes;\n    private _selectedElement: UIEventSource<any>;\n    private _dataIsLoading: UIEventSource<boolean>;\n    private _userDetails: UIEventSource<UserDetails>;\n\n    constructor(zoomlevel: UIEventSource<{ zoom: number }>,\n                lastClickLocation: UIEventSource<{ lat: number, lon: number }>,\n                changes: Changes,\n                selectedElement: UIEventSource<any>,\n                dataIsLoading: UIEventSource<boolean>,\n                userDetails: UIEventSource<UserDetails>,\n                addButtons: { name: string; icon: string; tags: Tag[]; layerToAddTo: FilteredLayer }[],\n    ) {\n        super(zoomlevel);\n        this._zoomlevel = zoomlevel;\n        this._lastClickLocation = lastClickLocation;\n        this._changes = changes;\n        this._selectedElement = selectedElement;\n        this._dataIsLoading = dataIsLoading;\n        this._userDetails = userDetails;\n        this.ListenTo(userDetails);\n        this.ListenTo(dataIsLoading);\n        this._addButtons = [];\n\n        for (const option of addButtons) {\n            // <button type='button'> looks SO retarded\n            // the default type of button is 'submit', which performs a POST and page reload\n            const button =\n                new Button(new FixedUiElement(\"Voeg hier een \" + option.name + \" toe\"),\n                    this.CreatePoint(option));\n            this._addButtons.push(button);\n        }\n    }\n\n    private CreatePoint(option: { name: string; icon: string; tags: Tag[]; layerToAddTo: FilteredLayer }) {\n        const self = this;\n        return () => {\n\n            console.log(\"Creating a new \", option.name, \" at last click location\");\n            const loc = self._lastClickLocation.data;\n            let feature = self._changes.createElement(option.tags, loc.lat, loc.lon);\n            option.layerToAddTo.AddNewElement(feature);\n            self._selectedElement.setData(feature.properties);\n        }\n    }\n\n    protected InnerRender(): string {\n        const header = \"<h2>Geen selectie</h2>\" +\n            \"Je klikte ergens waar er nog geen gezochte data is.<br/>\";\n        if (this._zoomlevel.data.zoom < 19) {\n            return header + \"Zoom verder in om een element toe te voegen.\";\n        }\n\n        if (this._dataIsLoading.data) {\n            return header + \"De data is nog aan het laden. Nog even geduld, dan kan je een punt toevoegen\";\n        }\n\n        if (!this._userDetails.data.loggedIn) {\n            return header + \"<a class='activate-osm-authentication'>Gelieve je aan te melden om een nieuw punt toe te voegen</a>\"\n        }\n\n        var html = \"\";\n        for (const button of this._addButtons) {\n            html += button.Render();\n        }\n        return header + html;\n    }\n\n    InnerUpdate(htmlElement: HTMLElement) {\n        super.InnerUpdate(htmlElement);\n        for (const button of this._addButtons) {\n            button.Update();\n        }\n        this._userDetails.data.osmConnection.registerActivateOsmAUthenticationClass();\n    }\n\n}"]}