{"version":3,"sources":["UI/UIElement.ts","UI/Base/FixedUiElement.ts","UI/Base/Button.ts","UI/SimpleAddUI.ts"],"names":[],"mappings":";;;;;;;AAGA,IAAA,SAAA;AAAA;AAAA,YAAA;AASI,WAAA,SAAA,CAAsB,MAAtB,EAAgD;AAFxC,SAAA,YAAA,GAAe,KAAf;AAGJ,SAAK,EAAL,GAAU,gBAAgB,SAAS,CAAC,MAApC;AACA,SAAK,OAAL,GAAe,MAAf;AACA,IAAA,SAAS,CAAC,MAAV;AACA,SAAK,QAAL,CAAc,MAAd;AACH;;AAGS,EAAA,SAAA,CAAA,SAAA,CAAA,QAAA,GAAV,UAAmB,MAAnB,EAA6C;AACzC,QAAI,MAAM,KAAK,SAAf,EAA0B;AACtB;AACH;;AACD,QAAM,IAAI,GAAG,IAAb;AACA,IAAA,MAAM,CAAC,WAAP,CAAmB,YAAA;AACf,MAAA,IAAI,CAAC,MAAL;AACH,KAFD;AAGH,GARS;;AAYH,EAAA,SAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,CAAf,EAA8B;AAC1B,SAAK,QAAL,GAAgB,CAAhB;AACA,SAAK,MAAL;AACH,GAHM;AEhCX,ADAA,AEAA,IDAA,ADAA,AEAA,WDAA,ADAA,AEAA,GDAA,ADAA,AEAA,ODAA,ADAA,AEAA,CDAA,ADAA,AEAA,aAAA,CDAA,ADAA,AEAA,CDAA,ADAA;ADqCI,EAAA,SAAA,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AEnCJ,ADAA,AEGA,AHiCQ,IEpCR,ADAA,AEGA,IHiCY,EEpCZ,KFoCmB,GCpCnB,ADoCsB,EGjCtB,GAAA,GHiC8B,CAAC,GGjC/B,CAAA,UHiCsB,CAAwB,KAAK,EAA7B,CAAd,IGjCR,CAAA;ADHA,ADAA;ACAA,ADAA,AEIA,AHiCQ,IGjCR,IHiCY,EErCZ,ADAA,EEIA,GAAA,AHiCmB,CErCnB,ADAA,ECAA,ADAA,EDqCwB,EGjCxB,CAAA,CHiCY,IAAoB,OAAO,GGjCvC,CAAA,CHiC4C,SAApC,EAA+C;AErC3B,ADAQ,AEOpC,AH+BY,EEtCgB,ADAQ,SCAR,ADAQ,CCAR,ADAQ,MCAR,EAAA,MAAA,ADAQ,CCAR,CDAQ,MAAA,CAAA;ADuCxB;AElCR,ADFA,ADqCK,WEnCL,ADFA,MCEA,CAAY,IAAZ,EAA6B,CDF7B,CAAY,IAAZ,CCEA,CDFwB,CCE4B,IAApD,EAAqE;AAAjB,ADFpD,QCEoD,ADFpD,ICEoD,CDFpD,GACI,CCCgD,KAAA,ADDhD,CCCgD,ADDhD,ECCgD,EDDhD,CAAA,IAAA,EAAM,SAAN,KAAgB,IADpB;ACEoD,AFqChD,IAAA,EErCgD,IAAA,CFqCzC,CAAC,CErCwC,EAAA,MFqChD,GAAoB,KAAK,WAAL,EAApB;AErCiE,ADAjE,AEKR,IFLQ,AEKR,KFLY,CAAC,KAAL,AEKR,GFLqB,IAAb;AEKR,AHiCQ,QAAI,KAAK,YAAT,EAAuB;AEtC3B,ADCC,AEIL,AHkCY,QEvCR,ECKJ,AHkCgB,GEvCZ,GACI,ACIR,CHkCuB,CGlCvB,AHkCwB,IEtChB,CAAA,IAAA,AFsCQ,CEtCR,IAAA,AFsC8B,EEtCxB,AFsCF,EAA8B,OEtClC,KAAgB,IADpB;ACK6B,AHmCjB,EGnCiB,MHmCjB,GGnCiB,CAAA,GHmCV,CAAC,OGnCS,EAAA,IHmCjB,CAAsB,CGnCL,CAAA,GHmCjB,CAA4B,OAA5B,GAAsC,MAAtC;AEtCR,ADCM,ADsCD,ECtCC,ECDN,GFqCI,EErCA,CAAC,GFuCM,EEvCX,CDCM,CAAA,CCDO,IAAb,IDCM,CAAA,WAAA,GAAV,YAAA;ACAI,ADCA,AEUJ,AH4BY,IEvCR,IFuCQ,CEvCJ,CAAC,CDCE,AEUX,IH4BmB,CCtCH,ADsCI,EEvChB,GAAgB,ADChB,CEUJ,CAAY,KDXR,CFuCQ,CAAsB,EG5BlC,EACY,CH2BA,CAA4B,OAA5B,GAAsC,KG5BlD,EAEY,EH0BA,KG5BZ,EAGY,eAHZ,EAIY,aAJZ,EAKY,WALZ,EAMY,UANZ,EAMkG;AFfjG,AESD,AH6BS,GCxCC,KEWV,KAAA,GAQI,MAAA,CAAA,IAAA,CAAA,IAAA,EAAM,SAAN,KAAgB,IARpB;ADVI,AFwCC,QExCG,IAAI,KAAK,EAAb,EAAiB;AAEb,ADEZ,AEeQ,IAAA,EDjBI,GDEZ,AEeY,CAAC,CDjBG,CAAC,KAAL,GAAa,ACiBjB,GFfR,AEe0B,SDjBW,ACiB7B,IDjBiB,GAAmB,GAAhC;AACH,ADZT,AE6BQ,AHsBA,CCnDR,CAAoC,EE6B5B,CDpBA,GF0CI,CGtBA,CAAC,CDjB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","file":"SimpleAddUI.js","sourceRoot":"..","sourcesContent":["import {UIEventSource} from \"./UIEventSource\";\nimport {Playground} from \"../Layers/Playground\";\n\nexport abstract class UIElement {\n\n    private static nextId: number = 0;\n\n    public readonly id: string;\n    public readonly _source: UIEventSource<any>;\n    \n    private _hideIfEmpty = false;\n\n    protected constructor(source: UIEventSource<any>) {\n        this.id = \"ui-element-\" + UIElement.nextId;\n        this._source = source;\n        UIElement.nextId++;\n        this.ListenTo(source);\n    }\n\n\n    protected ListenTo(source: UIEventSource<any>) {\n        if (source === undefined) {\n            return;\n        }\n        const self = this;\n        source.addCallback(() => {\n            self.Update();\n        })\n    }\n\n    private _onClick: () => void;\n\n    public onClick(f: (() => void)) {\n        this._onClick = f;\n        this.Update();\n    }\n\n    Update(): void {\n        let element = document.getElementById(this.id);\n        if (element === null || element === undefined) {\n            // The element is not painted\n            return;\n        }\n\n        element.innerHTML = this.InnerRender();\n        if (this._hideIfEmpty) {\n            if (element.innerHTML === \"\") {\n                element.parentElement.style.display = \"none\";\n            } else {\n                element.parentElement.style.display = undefined;\n            }\n        }\n\n        if (this._onClick !== undefined) {\n            console.log(\"Registering\")\n            const self = this;\n            element.onclick = () => {\n                console.log(\"Clicked!\")\n                self._onClick();\n            }\n            element.style.cursor = \"pointer\";\n        }\n\n        this.InnerUpdate(element);\n    }\n    \n    HideOnEmpty(hide : boolean){\n        this._hideIfEmpty = hide;\n        this.Update();\n        return this;\n    }\n    \n    // Called after the HTML has been replaced. Can be used for css tricks\n    InnerUpdate(htmlElement : HTMLElement){}\n\n    Render(): string {\n        return \"<span class='uielement' id='\" + this.id + \"'>\" + this.InnerRender() + \"</span>\"\n    }\n\n    AttachTo(divId: string) {\n        let element = document.getElementById(divId);\n        if(element === null){\n            console.log(\"SEVERE: could not attach UIElement to \", divId);\n            return;\n        }\n        element.innerHTML = this.Render();\n        this.Update();\n        return this;\n    }\n\n    protected abstract InnerRender(): string;\n    public Activate(): void {};\n\n    public IsEmpty(): boolean {\n        return this.InnerRender() === \"\";\n    }\n\n}","import {UIElement} from \"../UIElement\";\n\nexport class FixedUiElement extends UIElement {\n    private _html: string;\n\n    constructor(html: string) {\n        super(undefined);\n        this._html = html;\n    }\n\n    protected InnerRender(): string {\n        return this._html;\n    }\n\n\n}","import {UIElement} from \"../UIElement\";\n\nexport class Button extends UIElement {\n    private _text: UIElement;\n    private _onclick: () => void;\n    private _clss: string;\n\n    constructor(text: UIElement, onclick: (() => void), clss: string = \"\") {\n        super(undefined);\n        this._text = text;\n        this._onclick = onclick;\n        if (clss !== \"\") {\n\n            this._clss = \"class='\" + clss + \"'\";\n        }else{\n            this._clss = \"\";\n        }\n    }\n\n\n    protected InnerRender(): string {\n\n        return \"<form>\" +\n            \"<button id='button-\"+this.id+\"' type='button' \"+this._clss+\">\" + this._text.Render() +  \"</button>\" +\n            \"</form>\";\n    }\n\n    InnerUpdate(htmlElement: HTMLElement) {\n        super.InnerUpdate(htmlElement);\n        const self = this;\n        console.log(\"Update for \", htmlElement)\n        document.getElementById(\"button-\"+this.id).onclick = function(){\n            console.log(\"Clicked\");\n            self._onclick();\n        }\n    }\n\n}","import {UIElement} from \"./UIElement\";\nimport {UIEventSource} from \"./UIEventSource\";\nimport {Tag} from \"../Logic/TagsFilter\";\nimport {FilteredLayer} from \"../Logic/FilteredLayer\";\nimport {Changes} from \"../Logic/Changes\";\nimport {FixedUiElement} from \"./Base/FixedUiElement\";\nimport {Button} from \"./Base/Button\";\nimport {UserDetails} from \"../Logic/OsmConnection\";\n\n/**\n * Asks to add a feature at the last clicked location, at least if zoom is sufficient\n */\nexport class SimpleAddUI extends UIElement {\n    private _zoomlevel: UIEventSource<{ zoom: number }>;\n    private _addButtons: UIElement[];\n    private _lastClickLocation: UIEventSource<{ lat: number; lon: number }>;\n    private _changes: Changes;\n    private _selectedElement: UIEventSource<any>;\n    private _dataIsLoading: UIEventSource<boolean>;\n    private _userDetails: UIEventSource<UserDetails>;\n\n    constructor(zoomlevel: UIEventSource<{ zoom: number }>,\n                lastClickLocation: UIEventSource<{ lat: number, lon: number }>,\n                changes: Changes,\n                selectedElement: UIEventSource<any>,\n                dataIsLoading: UIEventSource<boolean>,\n                userDetails: UIEventSource<UserDetails>,\n                addButtons: { name: string; icon: string; tags: Tag[]; layerToAddTo: FilteredLayer }[],\n    ) {\n        super(zoomlevel);\n        this._zoomlevel = zoomlevel;\n        this._lastClickLocation = lastClickLocation;\n        this._changes = changes;\n        this._selectedElement = selectedElement;\n        this._dataIsLoading = dataIsLoading;\n        this._userDetails = userDetails;\n        this.ListenTo(userDetails);\n        this.ListenTo(dataIsLoading);\n        this._addButtons = [];\n\n        for (const option of addButtons) {\n            // <button type='button'> looks SO retarded\n            // the default type of button is 'submit', which performs a POST and page reload\n            const button =\n                new Button(new FixedUiElement(\"Voeg hier een \" + option.name + \" toe\"),\n                    this.CreatePoint(option));\n            this._addButtons.push(button);\n        }\n    }\n\n    private CreatePoint(option: { name: string; icon: string; tags: Tag[]; layerToAddTo: FilteredLayer }) {\n        const self = this;\n        return () => {\n\n            console.log(\"Creating a new \", option.name, \" at last click location\");\n            const loc = self._lastClickLocation.data;\n            let feature = self._changes.createElement(option.tags, loc.lat, loc.lon);\n            option.layerToAddTo.AddNewElement(feature);\n            self._selectedElement.setData(feature.properties);\n        }\n    }\n\n    protected InnerRender(): string {\n        const header = \"<h2>Geen selectie</h2>\" +\n            \"Je klikte ergens waar er nog geen gezochte data is.<br/>\";\n        if (this._zoomlevel.data.zoom < 19) {\n            return header + \"Zoom verder in om een element toe te voegen.\";\n        }\n\n        if (this._dataIsLoading.data) {\n            return header + \"De data is nog aan het laden. Nog even geduld, dan kan je een punt toevoegen\";\n        }\n\n        if (!this._userDetails.data.loggedIn) {\n            return header + \"<a class='activate-osm-authentication'>Gelieve je aan te melden om een nieuw punt toe te voegen</a>\"\n        }\n\n        var html = \"\";\n        for (const button of this._addButtons) {\n            html += button.Render();\n        }\n        return header + html;\n    }\n\n    InnerUpdate(htmlElement: HTMLElement) {\n        super.InnerUpdate(htmlElement);\n        for (const button of this._addButtons) {\n            button.Update();\n        }\n        this._userDetails.data.osmConnection.registerActivateOsmAUthenticationClass();\n    }\n\n}"]}